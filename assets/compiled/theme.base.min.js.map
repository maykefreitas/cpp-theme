{"version":3,"sources":["theme.base.min.js","app.js","blazy.js","categoryList.js","chat.js","checkout.js","ckeditor.js","colaborativeDiscussion.js","datepicker.js","examQuestionForm.js","fixOnScroll.js","follow.js","home.js","lessonList.js","lessonPage.js","mask.js","notepad.js","pagarme.js","postsForm.js","product.js","readmore.js","simpleEditor.js","studentDoubts.js","timezone.js","main.js"],"names":["window","app","bindGlobal","FastClick","attach","document","body","$","timeago","trigger","bindOpenOnLoad","toOpen","length","each","i","elem","open","attr","bindTooltips","tooltip","checkFormValidity","event","form","currentTarget","submitButton","find","checkValidity","removeAttr","init","on","scrollTop","$body","hasClass","addClass","removeClass","pagarme","bindBlazy","bindHome","bindProduct","bindMasks","bindReadMore","bindDatepicker","bindFixOnScroll","ckeditor","bindCkeditor","bindCheckout","lessonList","chat","studentDoubts","notepad","categoryList","bindExamQuestionForm","changeTimeZone","followBind","lessonPage","bindPostsForm","bindCollaborativeDiscussion","e","Blazy","self","this","$categoryList","isActive","data","bindClicks","expandParents","expandParent","parent","$parent","animate","$nextListGroup","first","$parentCategoryItem","stop","slideToggle","toggle","toggleClass","$loopItem","parents","groupsPagination","page","perPage","totalPages","collaboratorsPagination","followsPagination","$chat","$groups","$roomTitle","$roomUsersCount","$text","$messagesContainer","$messagesScroll","$sendForm","$loadMoreGroupsButton","$loadMoreCollaboratorsButton","$loadMoreStudentsButton","$generalChatGroup","user","schoolId","apiKey","userId","id","bindScroll","empty","keyup","code","keyCode","which","shiftKey","submitMessage","simpleEditor","firebase","initializeApp","CHAT_CONFIG","database","authenticate","loadSchoolGroup","didLoadSchoolGroup","loadGroups","didLoadGroups","loadCollaborators","didLoadCollaborators","loadFollows","didLoadFollows","changeRoom","listenConnectionChanges","ajax","url","CHAT_FIREBASE_SERVICE_HOST","method","headers","Authorization","success","auth","signInWithCustomToken","firebase_token","then","response","monitorConnectionState","error","console","userRef","ref","child","uid","snap","val","onDisconnect","set","onIdle","onAway","onBack","isIdle","isAway","connectionsRef","updateStatus","key","status","user_id","$element","height","parentHeight","isPercentHeight","indexOf","Number","replace","chatHeight","scrollbar","loadMessages","setMessage","insertMessage","bind","messages","limitToLast","sanitizeHtml","$root","remove","children","el","$el","tagName","last","get","pad","n","preventDefault","$html","text","html","focus","date","Date","push","name","avatar_url","timestamp","moment","unix","schedule","getHours","getMinutes","renderTemplate","avatar","format","append","scrollToEnd","scrollHeight","liquid","template","Liquid","parse","render","callback","CORE_HOST","group","is_school","prepend","total_pages","groups","_","sortBy","map","g","forEach","selectFirstRoomAvailable","addProfileItems","collaborators","users","divClass","roomName","ids","parseInt","sort","off","$selectedRoom","click","change","is","src","loadAsset","config","language","skin","index","ckeditorObj","placeholder","CKEDITOR","bindCkeditorSubmit","editor","$editor","$form","editorId","$submitButton","instances","getData","commentId","$comment","fn","datepicker","defaults","$hidden","insertBefore","frontDate","utc","serverDate","$question","optionIndex","assertionId","innerWidth","wrap","$wrapper","offset","size","width","outerWidth","outerHeight","top","css","position","left","z-index","mouseenter","mouseleave","owlCarousel","items","loop","autoplay","autoplayTimeout","dots","nav","margin","courseTreeExists","courseTree","course","enrollment","courseContent","userType","lessonActions","downloadAction","currentLessonId","translations","lessonProgress","completed","handleLessons","loadTopModules","bindChangeLesson","$mediaControls","enrollmentId","enrollment_id","progressIcon","requirementsExists","$item","content_id","checkLessonCompleted","lazyLoadButtons","lessons","currentLesson","toggleButton","lessonListPanel","type","iconType","progress","cb","requirementsElements","filter","item","requirementsUnified","idx","requirements","toArray","exists","lesson_id","lessons_progresses","bindChangeLessonActive","course_path_regex","lesson_path_regex","path","location","pathname","lesson_path","test","path_array","split","changeLesson","target","stopPropagation","loadChildren","toggleSidebar","getLessonIcon","lesson","lessonIcon","activity","media","getContentPath","content","courseId","getContentDownloadPath","checkLessonAvailability","releaseAt","release_at","releaseAfter","release_after","enrollmentActivatedAt","activated_at","releaseTime","add","checkTrialByType","$tree","constrains_name","payment_method","constrains_tree","trial_constrains","constrains","hasOwnProperty","fetchModules","level","$list","res","modules","course_modules","m","module","allModules","available","course_content_ids","$modules","fetchChildren","courseContents","course_contents","lessons_info","$courseContents","active","hideInProgressIcon","hideCompletedIcon","lessonReleased","releaseType","releaseDate","requirements_ids","in_progress","JSON","stringify","title","views","max_attendance_length","max_attendance_type","translation","zone","tz","guess","downloadable","checkNextButtonUnlocked","topModules","x","parent_course_module","disabled","prev","fadeOut","fadeIn","expandParentModules","parent_modules_hash","opacity","appendTo","when","slideDown","slideUp","originalEvent","$new","direction","$targetLesson","$prev","prevAll","$next","nextAll","parentModules","loopModule","course_module","parent_module","reverse","async","eachSeries","moduleId","$module","REGEX_COLLABORATIVE_DISCUSSIONS","REGEX_EXAM_ANSWERS","isCollaborativeDiscuttion","value","isExamAnswer","ajaxSuccess","xhr","settings","$currentItemIcon","phoneMaskBehavior","phoneMaskOptions","onKeyPress","field","options","mask","apply","arguments","noteContainer","loadNote","saveNote","note","note_id","$button","buttonLabel","prop","_id","buildCreditCard","creditCard","PagarMe","expiration","cardExpirationMonth","cardExpirationYear","cardHolderName","cardNumber","cardCVV","submitFormCreditCardHash","paymentForm","fieldErrors","hasErrors","log","creditCardTest","generateHash","cardHash","submit","pagarmeKey","encryption_key","post","$content","speed","collapsedHeight","moreText","lessText","currHeight","innerHeight","showLink","readmore","moreLink","lessLink","createShortcut","bindKey","isMac","navigator","platform","toUpperCase","bindFunction","character","String","fromCharCode","ctrl","ctrlKey","meta","metaKey","score","handleDrag","handleDrop","clientX","y","clientY","file","dataTransfer","files","URLObj","URL","webkitURL","source","createObjectURL","match","img","createElement","range","caretPositionFromPoint","pos","createRange","setStart","offsetNode","collapse","insertNode","caretRangeFromPoint","updateButtons","bold","queryCommandState","italic","underline","container","$container","$input","$btnAction","registerTriggers","registerDropZone","registerShortcuts","action","execCommand","dropZone","doubtsContainer","expandButton","hideButton","loadMoreButton","loadDoubts","per_page","complete","hide","$btn","time","ready"],"mappings":"AAAA,cCAA,WAGAA,OAAAC,KACAC,WAAA,WACAC,UAAAC,OAAAC,SAAAC,MAEAC,EAAA,YAAAC,UAEAD,EAAAF,UAAAI,QAAA,oBAGAC,eAAA,WACA,GAAAC,GAAAJ,EAAA,mBACAI,GAAAC,OAAA,GACAL,EAAAM,KAAAF,EAAA,SAAAG,EAAAC,GACAf,OAAAgB,KAAAT,EAAAQ,GAAAE,KAAA,WAIAV,EAAAF,UAAAI,QAAA,0BAGAS,aAAA,WACAX,EAAA,2BACAY,QAAA,WACAA,UAEAZ,EAAAF,UAAAI,QAAA,sBAGAW,kBAAA,SAAAC,GACA,GAAAC,GAAAD,EAAAE,cACAC,EAAAjB,EAAAe,GAAAG,KAAA,wBAEAH,GAAAI,gBACAF,EAAAG,WAAA,YAEAH,EAAAP,KAAA,WAAA,YAGAV,EAAAF,UAAAI,QAAA,iCAGAmB,KAAA,WACArB,EAAAF,UAAAwB,GAAA,SAAA,WACA,GAAAC,GAAAvB,EAAAF,UAAAyB,YACAC,EAAAxB,EAAA,OAEAuB,GAAA,IAAAC,EAAAC,SAAA,YACAD,EAAAE,SAAA,YACAH,GAAA,GAAAC,EAAAC,SAAA,aACAD,EAAAG,YAAA,cAIAjC,IAAAkC,QAAAP,OACA3B,IAAAC,aACAD,IAAAmC,YACAnC,IAAAS,iBACAT,IAAAoC,WACApC,IAAAqC,cACArC,IAAAsC,YACAtC,IAAAiB,eACAjB,IAAAuC,eACAvC,IAAAwC,iBACAxC,IAAAyC,kBACAzC,IAAA0C,SAAAC,eACA3C,IAAA4C,eACA5C,IAAA6C,WAAAlB,OACA3B,IAAA8C,KAAAnB,OACA3B,IAAA+C,cAAApB,OACA3B,IAAAgD,QAAArB,OACA3B,IAAAiD,aAAAtB,OACA3B,IAAAkD,uBACAlD,IAAAmD,iBACAnD,IAAAoD,aACApD,IAAAqD,aACArD,IAAAsD,gBAEAhD,EAAAF,UAAAwB,GAAA,2BAAA5B,IAAAuD,kCChFA,WAGAvD,IAAAmC,UAAA,SAAAqB,GACA,GAAAC,OAEAnD,EAAAF,UAAAI,QAAA,sBCNA,WAGAR,IAAAiD,cACAtB,KAAA,WACA,GAAA+B,GAAAC,IACAD,GAAAE,cAAAtD,EAAA,qBAEA,GAAAoD,EAAAE,cAAAjD,SAEA+C,EAAAG,SAAAH,EAAAE,cAAAE,KAAA,cAAAJ,EAAAG,SAEAH,EAAAG,WACAH,EAAAK,aACAL,EAAAE,cAAA5C,KAAA,kBAAA,GACA0C,EAAAG,UAAA,GAGAH,EAAAM,kBAGAD,WAAA,WACA,GAAAL,GAAAC,IAEArD,GAAAF,UAAAwB,GAAA,QAAA,+CAAA,WACA8B,EAAAO,aAAA3D,EAAAqD,MAAAO,OAAA,mBAAA,MAIAD,aAAA,SAAAE,EAAAC,GACA,GAAAC,GAAAF,EAAA3C,KAAA,eAAA8C,QACAC,EAAAJ,CAEAC,GACAC,EAAAG,OAAAC,YAAA,QAEAJ,EAAAG,OAAAE,SAGAH,EAAAI,YAAA,aAGAX,cAAA,WAIA,IAHA,GAAAN,GAAAC,KACAiB,EAAAlB,EAAAE,cAAApC,KAAA,0BAAA8C,QAEAM,GAAA,CACAlB,EAAAO,aAAAW,GAAA,EAEA,IAAAT,GAAAS,EACAC,QAAA,kBACAP,OAGAM,GADAT,EAAAxD,OAAA,EACAwD,EAEA,WCxDA,WAGAnE,IAAA8C,MACAgC,kBACAC,KAAA,EACAC,QAAA,EACAC,WAAA,GAEAC,yBACAH,KAAA,EACAC,QAAA,EACAC,WAAA,GAEAE,mBACAJ,KAAA,EACAC,QAAA,EACAC,WAAA,GAGAtD,KAAA,WACA,GAAA+B,GAAAC,IAEAD,GAAA0B,MAAA9E,EAAA,YACAoD,EAAA2B,QAAA/E,EAAA,cACAoD,EAAA4B,WAAAhF,EAAA,kBACAoD,EAAA6B,gBAAAjF,EAAA,wBACAoD,EAAA8B,MAAAlF,EAAA,iBACAoD,EAAA+B,mBAAAnF,EAAA,iCACAoD,EAAAgC,gBAAApF,EAAA,gCACAoD,EAAAiC,UAAArF,EAAA,qBACAoD,EAAAkC,sBAAAlC,EAAA0B,MAAA5D,KAAA,wBACAkC,EAAAmC,6BAAAnC,EAAA0B,MAAA5D,KAAA,+BACAkC,EAAAoC,wBAAApC,EAAA0B,MAAA5D,KAAA,0BACAkC,EAAAqC,kBAAArC,EAAA0B,MAAA5D,KAAA,0BAEAkC,EAAAsC,KAAA1F,EAAA,kBAAAwD,KAAA,QAEAJ,EAAAsC,OAIAtC,EAAAuC,SAAAvC,EAAA0B,MAAAtB,KAAA,aACAJ,EAAAwC,OAAAxC,EAAA0B,MAAAtB,KAAA,WACAJ,EAAAyC,OAAAzC,EAAAsC,KAAAI,GAEA1C,EAAA0B,MAAAzE,QAAA,IAEA+C,EAAA2C,aAEA3C,EAAA+B,mBAAAa,QAGA5C,EAAA8B,MAAAe,MAAA,SAAA/C,GACA,GAAAgD,GAAAhD,EAAAiD,QAAAjD,EAAAiD,QAAAjD,EAAAkD,KACA,MAAAF,GAAAhD,EAAAmD,UACAjD,EAAAkD,cAAApD,KAIAxD,IAAA6G,aAAAlF,KAAA,qBACA+B,EAAAiC,UAAA/D,GAAA,SAAA8B,EAAAkD,eAEAE,SAAAC,cAAAhH,OAAAiH,aACAtD,EAAAuD,SAAAH,SAAAG,WAEAvD,EAAAwD,eAEAxD,EAAAyD,gBAAAzD,EAAA0D,oBACA1D,EAAA2D,WAAA3D,EAAA4D,eACA5D,EAAA6D,kBAAA7D,EAAA8D,sBACA9D,EAAA+D,YAAA/D,EAAAgE,gBAEAhE,EAAAkC,sBAAAhE,GAAA,QAAA,WACA8B,EAAA2D,WAAA3D,EAAA4D,iBAGA5D,EAAAmC,6BAAAjE,GAAA,QAAA,WACA8B,EAAA6D,kBAAA7D,EAAA8D,wBAGA9D,EAAAoC,wBAAAlE,GAAA,QAAA,WACA8B,EAAA+D,YAAA/D,EAAAgE,kBAGAhE,EAAAqC,kBAAAnE,GAAA,QAAA,WACA8B,EAAAiE,YACArG,cAAAoC,EAAAqC,sBAIArC,EAAAkE,6BAGAV,aAAA,WACA,GAAAxD,GAAA1D,IAAA8C,IACAxC,GAAAuH,MACAC,IAAA/H,OAAAgI,2BAAA,gBACAC,OAAA,OACAC,SACAC,cAAAxE,EAAAwC,UAEAiC,QAAA,SAAArE,GACAgD,SAAAsB,OAAAC,sBAAAvE,EAAAzD,KAAAiI,gBACAC,KAAA,SAAAC,GACA9E,EAAA+E,uBAAAD,KAFA1B,SAIA,SAAA4B,GACAC,QAAAD,MAAA,+BAAAA,OAEAA,MAAA,SAAAA,GACAC,QAAAD,MAAA,0BACAC,QAAAD,MAAAA,MAIAD,uBAAA,SAAAD,GACA,GACAI,IADA5I,IAAA8C,KACAgE,SAAAG,WAAA4B,IAAA,eAAAC,MAAAN,EAAAO,KAGAjC,UAAAG,WAAA4B,IAAA,mBACAjH,GAAA,QAAA,SAAAoH,GACAA,EAAAC,QAEAL,EAAAM,eAAAC,IAAA,WAEAP,EAAAO,IAAA,aAIA/I,SAAAgJ,OAAA,WACAR,EAAAO,IAAA,SAGA/I,SAAAiJ,OAAA,WACAT,EAAAO,IAAA,SAGA/I,SAAAkJ,OAAA,SAAAC,EAAAC,GACAZ,EAAAO,IAAA,YAIAvB,wBAAA,WACA,GAAAlE,GAAA1D,IAAA8C,KACA2G,EAAA9F,KAAAsD,SAAA4B,IAAA,cAEAY,GAAA7H,GAAA,cAAA,SAAAkC,GACAJ,EAAAgG,aAAA5F,EAAAmF,MAAAnF,EAAA6F,OAGAF,EAAA7H,GAAA,gBAAA,SAAAkC,GACAJ,EAAAgG,aAAA5F,EAAAmF,MAAAnF,EAAA6F,OAGAF,EAAA7H,GAAA,gBAAA,SAAAkC,GACAJ,EAAAgG,aAAA5F,EAAAmF,MAAA,cAIAS,aAAA,SAAAE,EAAAC,GACA,GAAAC,GAAAxJ,EAAA,cAAAuJ,EAAA,MAAA,EACAC,IACAxJ,EAAA,kBAAAwJ,GAAAxF,QAAAtD,KAAA,QAAA,aAAA4I,IAIAvD,WAAA,WACA,GAAA0D,GAAApG,KAAAyB,MAAAtB,KAAA,UACAI,EAAAP,KAAAyB,MAAAtB,KAAA,UACAkG,EAAA9F,EAAA5D,EAAA4D,GAAA6F,SAAAzJ,EAAAP,QAAAgK,SACAE,EAAAF,EAAAG,QAAA,OACAH,GAAAI,OAAAJ,EAAAK,QAAA,IAAA,IAAAA,QAAA,KAAA,KAEAH,KAAA,EACAtG,KAAA0G,WAAAL,EAAA,IAAAD,EAEApG,KAAA0G,WAAAN,EAGApG,KAAAyB,MAAA2E,OAAApG,KAAA0G,YACA1G,KAAAyB,MAAA5D,KAAA,sBAAA8I,cACA3G,KAAAyB,MAAA5D,KAAA,gCAAA8I,eAGAC,aAAA,WACA,GAAA7G,GAAA1D,IAAA8C,KACA0H,EAAA,SAAA1G,GACAJ,EAAA+G,cAAA3G,EAAAmF,QACAyB,KAAAhH,EAEAA,GAAAiH,SAAAC,YAAA,IAAAhJ,GAAA,cAAA4I,GACA9G,EAAAiH,SAAAC,YAAA,IAAAhJ,GAAA,gBAAA4I,IAGAK,aAAA,SAAAC,GAgBA,MAfAA,GAAAtJ,KAAA,aAAAuJ,SAGAD,EAAAE,WAAApK,KAAA,SAAAC,EAAAoK,GACA,GAAAC,GAAA5K,EAAA2K,EACA,QAAAA,EAAAE,SAAAD,EAAA1J,KAAA,MAAAb,OAAA,GAAAuK,EAAA1J,KAAA,MAAAb,QAAAuK,EAAAF,WAAArK,QACAuK,EAAAH,WAKA,OAAAD,EAAAM,OAAAC,IAAA,GAAAF,SACAL,EAAAM,OAAAL,SAGAD,GAGAlE,cAAA,SAAAxF,GAWA,QAAAkK,GAAAC,GACA,MAAAA,GAAA,GAAA,IAAAA,EAAAA,EAXAnK,EAAAoK,gBACA,IAAA9H,GAAA1D,IAAA8C,KAEA2I,EAAA/H,EAAAmH,aAAAnH,EAAA8B,OACAkG,EAAAD,EAAAE,MAEA,MAAAD,EAAA/K,QAAA,GAAA,CAEA+C,EAAA8B,MAAAmG,KAAA,IAAAC,OAMA,IAAAC,GAAA,GAAAC,KAEApI,GAAAiH,SAAAoB,MACA3F,GAAA1C,EAAAsC,KAAAI,GACA4F,KAAAtI,EAAAsC,KAAAgG,KACAC,WAAAvI,EAAAsC,KAAAiG,WACAP,KAAAA,EACAQ,UAAAC,SAAAC,OACAC,SAAAf,EAAAO,EAAAS,YAAA,IAAAhB,EAAAO,EAAAU,kBAIA9B,cAAA,SAAA3G,GACA,GAAAJ,GAAA1D,IAAA8C,KACA6I,EAAAjI,EAAA8I,eAAA,gBACAC,OAAA3I,EAAAmI,WACAD,KAAAlI,EAAAkI,KACAN,KAAA5H,EAAA4H,KACAW,SAAAF,OAAAC,KAAAtI,EAAAoI,WAAAQ,OAAA,QAGAhJ,GAAA+B,mBAAAkH,OAAAhB,GACAjI,EAAAkJ,eAGAA,YAAA,WACA,GAAAlJ,GAAAC,IACAD,GAAAgC,gBAAA7D,UAAA6B,EAAAgC,gBAAA,GAAAmH,eAGAL,eAAA,SAAA7C,EAAA7F,GACA,GAAAgJ,GAAAxM,EAAA,IAAAqJ,EAAA,aAAAgC,OACAoB,EAAAC,OAAAC,MAAAH,EAEA,OAAAC,GAAAG,OAAApJ,IAGAqD,gBAAA,SAAAgG,GACA,GAAAzJ,GAAA1D,IAAA8C,IACAxC,GAAAuH,MACAC,IAAA/H,OAAAqN,UAAA,qBACApF,OAAA,MACAC,SACAC,cAAA,eAAAxE,EAAAwC,UAEAiC,QAAA,SAAArE,GACAqJ,EAAArJ,MAIAuD,WAAA,SAAA8F,GACA,GAAAzJ,GAAA1D,IAAA8C,IACAY,GAAAkC,sBAAA5E,KAAA,WAAA,YAEAV,EAAAuH,MACAC,IAAA/H,OAAAqN,UAAA,yBAAA1J,EAAAoB,iBAAAE,QAAA,UAAAtB,EAAAoB,iBAAAC,KAAA,GACAiD,OAAA,MACAC,SACAC,cAAA,eAAAxE,EAAAwC,UAEAiC,QAAA,SAAArE,GACAJ,EAAAoB,iBAAAC,KAAArB,EAAAoB,iBAAAC,KAAA,EACArB,EAAAkC,sBAAAlE,WAAA,WAAA,YACAyL,EAAArJ,MAIAyD,kBAAA,SAAA4F,GACA,GAAAzJ,GAAA1D,IAAA8C,IACAY,GAAAmC,6BAAA7E,KAAA,WAAA,YAEAV,EAAAuH,MACAC,IAAA/H,OAAAqN,UAAA,gCAAA1J,EAAAwB,wBAAAF,QAAA,UAAAtB,EAAAwB,wBAAAH,KAAA,GACAiD,OAAA,MACAC,SACAC,cAAA,eAAAxE,EAAAwC,UAEAiC,QAAA,SAAArE,GACAJ,EAAAwB,wBAAAH,KAAArB,EAAAwB,wBAAAH,KAAA,EACArB,EAAAmC,6BAAAnE,WAAA,WAAA,YACAyL,EAAArJ,MAIA2D,YAAA,SAAA0F,GACA,GAAAzJ,GAAA1D,IAAA8C,IACAY,GAAAoC,wBAAA9E,KAAA,WAAA,YAEAV,EAAAuH,MACAC,IAAA/H,OAAAqN,UAAA,0BAAA1J,EAAAyB,kBAAAH,QAAA,UAAAtB,EAAAyB,kBAAAJ,KAAA,GACAiD,OAAA,MACAC,SACAC,cAAA,eAAAxE,EAAAwC,UAEAiC,QAAA,SAAArE,GACAJ,EAAAyB,kBAAAJ,KAAArB,EAAAyB,kBAAAJ,KAAA,EACArB,EAAAoC,wBAAApE,WAAA,WAAA,YACAyL,EAAArJ,MAIAsD,mBAAA,SAAAiG,GACA,GAAA3J,GAAA1D,IAAA8C,IAEAuK,GAAAC,WAAA,CAEA,IAAA7B,GAAAnL,EAAAoD,EAAA8I,eAAA,uBAAAa,GACA5B,GAAA7J,GAAA,QAAA5B,IAAA8C,KAAA6E,YACAjE,EAAA2B,QAAAkI,QAAA9B,IAGAnE,cAAA,SAAAxD,GACA,GAAAJ,GAAA1D,IAAA8C,IAEAY,GAAAoB,iBAAAG,WAAAnB,EAAA0J,YAEA9J,EAAAoB,iBAAAC,MAAArB,EAAAoB,iBAAAG,YACAvB,EAAAkC,sBAAA5E,KAAA,WAAA,WAGA,IAAAyM,GAAA3J,EAAA2J,MACAA,GAAAC,EAAAC,OAAAF,GAAAH,WAAA,IACAG,EAAAC,EAAAE,IAAAH,EAAA,SAAAI,GAEA,MADAA,GAAAP,WAAA,EACAO,IAGAJ,EAAAK,QAAA,SAAAT,GACA,GAAA5B,GAAAnL,EAAAoD,EAAA8I,eAAA,uBAAAa,GACA5B,GAAA7J,GAAA,QAAA5B,IAAA8C,KAAA6E,YACAjE,EAAA2B,QAAAsH,OAAAlB,KAGA/H,EAAAqK,4BAGAvG,qBAAA,SAAA1D,GACA,GAAAJ,GAAA1D,IAAA8C,IAEAY,GAAAwB,wBAAAD,WAAAnB,EAAA0J,YAEA9J,EAAAwB,wBAAAH,MAAArB,EAAAwB,wBAAAD,YACAvB,EAAAmC,6BAAA7E,KAAA,WAAA,YAGA0C,EAAAsK,gBAAAlK,EAAAmK,cAAA,WACAvK,EAAAqK,4BAGArG,eAAA,SAAA5D,GACA,GAAAJ,GAAA1D,IAAA8C,IACAY,GAAAyB,kBAAAF,WAAAnB,EAAA0J,YAEA9J,EAAAyB,kBAAAJ,MAAArB,EAAAyB,kBAAAF,YACAvB,EAAAoC,wBAAA9E,KAAA,WAAA,YAGA0C,EAAAsK,gBAAAlK,EAAAoK,MAAA,eACAxK,EAAAqK,4BAGAC,gBAAA,SAAAE,EAAAC,GACA,GAAAzK,GAAA1D,IAAA8C,IAEAoL,GAAAJ,QAAA,SAAA9H,GACA,GAAAyF,GAAAnL,EAAAoD,EAAA8I,eAAA,yBAAAxG,GACAyF,GAAA7J,GAAA,QAAA5B,IAAA8C,KAAA6E,YACArH,EAAA,IAAA6N,GAAAxB,OAAAlB,MAIA9D,WAAA,SAAAvG,GACA,GAAAsC,GAAA1D,IAAA8C,KACAgH,EAAAxJ,EAAAc,EAAAE,cAEAhB,GAAA,2BAAA2B,YAAA,UACA6H,EAAA9H,SAAA,SAEA,IAAAoM,GAAA,UAEA,IAAA,aAAAtE,EAAAhG,KAAA,QAEAsK,GAAA,aAAAtE,EAAAhG,KAAA,MAGAJ,EAAA4B,WAAAqG,KAAArL,EAAA,sBAAAwJ,GAAA6B,QACAjI,EAAA6B,gBAAAoG,KAAArL,EAAA,6BAAAwJ,GAAA6B,YACA,IAAA,UAAA7B,EAAAhG,KAAA,QAAA,CACA,GAAAuK,IAAA3K,EAAAyC,OAAAmI,SAAAxE,EAAAhG,KAAA,QAAAyK,MACAH,IAAA,UAAAC,EAAA,GAAA,IAAAA,EAAA,GAGA3K,EAAA4B,WAAAqG,KAAArL,EAAA,cAAAwJ,GAAA6B,QACAjI,EAAA6B,gBAAAoG,KAAArL,EAAA,kBAAAwJ,GAAA6B,YACA,YAAA7B,EAAAhG,KAAA,UAEAsK,GAAA,YAAA1K,EAAAuC,SAGAvC,EAAA4B,WAAAqG,KAAArL,EAAA,sBAAAwJ,GAAA6B,QACAjI,EAAA6B,gBAAAoG,KAAArL,EAAA,6BAAAwJ,GAAA6B,QAGAjI,GAAA+B,mBAAAkG,KAAA,IAEAjI,EAAAiH,UACAjH,EAAAiH,SAAA6D,MAGA9K,EAAAiH,SAAAjH,EAAAuD,SAAA4B,IAAAuF,GACA1K,EAAA6G,gBAGAwD,yBAAA,WACArK,KAAA+K,gBAEA/K,KAAA+K,cAAAnO,EAAA,2BAAAgE,QACAZ,KAAA+K,cAAAC,cC/bA,WAGA1O,IAAA4C,aAAA,WACAtC,EAAA,0BAAAqO,OAAA,WACArO,EAAAqD,MAAAiL,GAAA,eAAA,EACAtO,EAAA,sBAAA2B,YAAA,YAEA3B,EAAA,sBAAA0B,SAAA,cAIA1B,EAAAF,UAAAI,QAAA,yBCZA,WAGAR,IAAA0C,UACAC,aAAA,WACA,GAAAkM,GAAA,mDAEAvO,GAAA,gBAAAK,QACAmO,UAAA,kBAAAD,EAAA,WACA,GAAAE,IACAC,SAAA,QACAC,KAAA,cAGA3O,GAAA,gBAAAM,KAAA,SAAAsO,EAAAC,GACA7O,EAAA,QAAA6O,EAAA/I,IAAAzF,SACAoO,EAAAK,YAAAD,EAAAC,YAEAC,SAAAjF,QAAA+E,EAAA/I,GAAA2I,MAIA/O,IAAA0C,SAAA4M,qBACAhP,EAAAF,UAAAI,QAAA,wBAKA8O,mBAAA,WACAhP,EAAAM,KAAAN,EAAA,gBAAA,SAAA4O,EAAAK,GACA,GAAAC,GAAAlP,EAAAiP,GACAE,EAAAD,EAAA3K,QAAA,QACA6K,EAAAF,EAAAxO,KAAA,KAEA,IAAAyO,EAAA,CACA,GAAAE,GAAAF,EAAAjO,KAAA,wBAEA6N,UAAAO,UAAAF,GAAA9N,GAAA,SAAA,WACA+B,KAAAkM,UAAAlP,OACAgP,EAAA3O,KAAA,YAAA,GAEA2O,EAAA3O,KAAA,YAAA,QAMAV,EAAAF,UAAAI,QAAA,iCC/CA,WAGAR,IAAAuD,4BAAA,WACAjD,EAAAF,UAAAwB,GAAA,QAAA,4CAAA,WACA,GAAAkO,GAAAxP,EAAAqD,MAAAG,KAAA,cACAiM,EAAAzP,EAAA,eAAAwP,EAEAC,GAAAvO,KAAA,oBAAAQ,SAAA,QACA+N,EAAAvO,KAAA,sBAAAS,YAAA,UAGA3B,EAAAF,UAAAwB,GAAA,QAAA,8CAAA,WACA,GAAAkO,GAAAxP,EAAAqD,MAAAG,KAAA,cACAiM,EAAAzP,EAAA,eAAAwP,EAEAC,GAAAvO,KAAA,oBAAAS,YAAA,QACA8N,EAAAvO,KAAA,sBAAAQ,SAAA,UAIA1B,EAAAF,UAAAI,QAAA,yCCrBA,WAGAR,IAAAwC,eAAA,WAEAlC,EAAA0P,GAAAC,WAAAC,SAAAlB,SAAA,QAEA1O,EAAA,eAAAM,KAAA,SAAAC,EAAAoK,GACA,GAAAC,GAAA5K,EAAA2K,GACAkF,EAAA7P,EAAA,2BAAA8P,aAAAlF,EAAAhH,UACAmM,EAAAlE,OAAAjB,EAAAjC,OAAAqH,MAAA5D,OAAA,cACA6D,EAAApE,OAAAjB,EAAAjC,OAAAqH,MAAA5D,OAAA,aACA6D,GAAA,iBAAAA,EAAA,KAAAA,EAEAJ,EAAAnP,KAAA,KAAAkK,EAAAlK,KAAA,OACAmP,EAAAnP,KAAA,OAAAkK,EAAAlK,KAAA,SACAmP,EAAAnP,KAAA,QAAAuP,GAEArF,EAAAxJ,WAAA,MACAwJ,EAAAxJ,WAAA,QAEA,KAAAwJ,EAAAjC,OACAiC,EAAAjC,IAAAoH,GAGA/P,EAAA2K,GAAAgF,aACArO,GAAA,SAAA,WACA,GAAAiK,GAAAM,OAAAjB,EAAAjC,MAAA,cAAAqH,MAAA5D,OAAA,aACAb,GAAA,iBAAAA,EAAA,KAAAA,EACAsE,EAAAlH,IAAA4C,OAIAvL,EAAAF,UAAAI,QAAA,2BCjCA,WAGAR,IAAAkD,qBAAA,WACA5C,EAAAF,UAAAwB,GAAA,QAAA,kBAAA,WACAtB,EAAA,sBAAA0B,SAAA,QACA1B,EAAA,mBAAA2B,YAAA,UAGA3B,EAAAF,UAAAwB,GAAA,QAAA,gCAAA,WACAtB,EAAAqD,MAAAkB,QAAA,yBACArD,KAAA,0CACAE,WAAA,cAGApB,EAAAF,UAAAwB,GAAA,SAAA,yBAAA,WACA,GAAA4O,GAAAlQ,EAAAqD,MAAAkB,QAAA,yBACA4L,EAAAnQ,EAAAqD,MAAAG,KAAA,gBACA4M,EAAApQ,EAAAqD,MAAAnC,KAAA,mBAAAsC,KAAA,qBAEA0M,GAAAhP,KAAA,8CAAAiP,EAAA,MAAAxH,IAAAyH,KAIApQ,EAAAF,UAAAwB,GAAA,SAAA,oBAAA5B,IAAAmB,mBAEAb,EAAAF,UAAAwB,GAAA,uBAAA,oBAAA5B,IAAAmB,mBAEAb,EAAAF,UAAAI,QAAA,wCC5BA,WAGAR,IAAAyC,gBAAA,WACAnC,EAAA,qBAAAM,KAAA,SAAAC,EAAAoK,GACA,GAAA3K,EAAA2K,GAAAlJ,SAAA,8BAAAhC,OAAA4Q,WAAA,KAAA,CAIA,GAAAzF,GAAA5K,EAAA2K,EACAC,GAAA0F,KAAA,uCACA,IAAAC,GAAA3F,EAAAhH,OAAA,0BAEA4M,EAAA5F,EAAA4F,SACAC,GACAC,MAAA9F,EAAA+F,aACAlH,OAAAmB,EAAAgG,cAGAL,GAAAG,MAAAD,EAAAC,OACAH,EAAA9G,OAAAgH,EAAAhH,QAEAzJ,EAAAF,UAAAwB,GAAA,SAAA,SAAA4B,GACA,GAAA3B,GAAAvB,EAAAF,UAAAyB,WAEA,IAAAA,GAAAiP,EAAAK,IAAA,CACA,GAAA,UAAAjG,EAAAkG,IAAA,YAAA,MAEAlG,GAAAhH,SAAAlC,SAAA,UACAkJ,EAAAlJ,SAAA,UACAkJ,EAAAkG,KACAC,SAAA,QACAC,KAAAR,EAAAQ,KACAH,IAAA,EACAH,MAAAD,EAAAC,MACAjH,OAAAgH,EAAAhH,OACAwH,UAAA,cAEA,CACA,GAAA,WAAArG,EAAAkG,IAAA,YAAA,MAEAlG,GAAAjJ,YAAA,UACAiJ,EAAAhH,SAAAjC,YAAA,UACAiJ,EAAAkG,KACAC,SAAA,SACAC,KAAA,OACAH,IAAA,OACAH,MAAA,OACAjH,OAAA,mBChDA,WAGA/J,IAAAoD,WAAA,WACA9C,EAAAF,UAAAwB,IACA4P,WAAA,WACAlR,EAAAqD,MAAA3B,SAAA,UACA1B,EAAA,gBAAA2B,YAAA,YAEA,iBAEA3B,EAAAF,UAAAwB,IACA6P,WAAA,WACAnR,EAAA,iBAAA2B,YAAA,UACA3B,EAAAqD,MAAA3B,SAAA,YAEA,oBChBA,WAGAhC,IAAAoC,SAAA,WACA9B,EAAA,mBAAAoR,aACAC,MAAA,EACAC,MAAA,EACAC,UAAA,EACAC,gBAAA,IACAC,MAAA,EACAC,KAAA,IAGA1R,EAAA,0BAAAoR,aACAC,MAAA,EACAC,MAAA,EACAG,MAAA,EACAC,KAAA,EACAC,OAAA,IAGA3R,EAAA,oCAAAsB,GAAA,QAAA,SAAA4B,GACAA,EAAAgI,gBAEA,IAAAN,GAAA5K,EAAAqD,MACA8H,EAAAnL,EAAA4K,EAAApH,KAAA,QAEAxD,GAAA,uCAAAqL,KAAAF,SC3BA,WAGAzL,IAAA6C,YACAlB,KAAA,WACA,GAAA+B,GAAAC,IAEAD,GAAAwO,iBAAAxO,EAAAyO,aAAAxR,OACA+C,EAAAG,SAAAH,EAAAyO,aAAArO,KAAA,aACAJ,EAAA0O,OAAA1O,EAAAyO,aAAArO,KAAA,UACAJ,EAAA2O,WAAA3O,EAAAyO,aAAArO,KAAA,cACAJ,EAAA4O,cAAA5O,EAAAyO,aAAArO,KAAA,kBACAJ,EAAA6O,SAAA7O,EAAAyO,aAAArO,KAAA,aACAJ,EAAA8O,cAAA9O,EAAAyO,aAAArO,KAAA,kBACAJ,EAAA+O,eAAA/O,EAAAyO,aAAArO,KAAA,mBACAJ,EAAAgP,gBAAApE,SAAA5K,EAAAyO,aAAArO,KAAA,sBACAJ,EAAAwC,OAAAxC,EAAAyO,aAAArO,KAAA,WAEAJ,EAAAiP,gBACAjP,EAAAiP,aAAA,qBAAAjP,EAAAyO,aAAArO,KAAA,0BACAJ,EAAAiP,aAAA,wBAAAjP,EAAAyO,aAAArO,KAAA,6BACAJ,EAAAiP,aAAA,gCAAAjP,EAAAyO,aAAArO,KAAA,oCAEAJ,EAAAkP,kBAAAlP,EAAAkP,iBAAAC,WACAvS,EAAA,oBAAA2B,YAAA,YAGAyB,EAAAwO,mBAAAxO,EAAAG,WACAH,EAAAK,aACAL,EAAAoP,gBACApP,EAAAqP,iBACArP,EAAAsP,mBAEA1S,EAAAF,UAAAI,QAAA,2BAEAF,EAAAF,UAAAwB,GAAA,mBAAA,SAAAR,EAAAwR,GACA,GAAAK,GAAA3S,EAAA,oBACA4S,EAAAN,EAAA9O,KAAAqP,aAEAzP,GAAA0P,aAAA,aAAArR,SAAA,SACA2B,EAAA0P,aAAA,aAAAnR,YAAA,QAGAyB,EAAA0P,aAAA,YAAArR,SAAA,SACA2B,EAAA0P,aAAA,YAAApR,SAAA,QAIAiR,EAAAlC,OAAA,GACAkC,EAAAhR,YAAA,YAGAjC,IAAA6C,WAAAwQ,mBAAAT,EAAA9O,KAAA,SAAAwP,EAAAC,GACAD,GAAAC,GACAvT,IAAA6C,WAAA2Q,qBAAAN,EAAAK,EAAA,SAAAV,GACAA,IACAS,EAAArR,YAAA,WACAqR,EAAA9R,KAAA,uBAAAuJ,kBAWAoH,WAAA,WACA,MAAA7R,GAAA,yCAGAmT,gBAAA,WACA,MAAAnT,GAAA,+FAGAoT,QAAA,WACA,MAAA/P,MAAAwO,aAAA3Q,KAAA,gBAGAmS,cAAA,WACA,MAAArT,GAAAqD,KAAAwO,aAAA3Q,KAAA,sBAAA,KAGAoS,aAAA,WACA,MAAAtT,GAAA,6BAGAuT,gBAAA,WACA,MAAAvT,GAAA,uBAGAsS,eAAA,WACA,MAAAtS,GAAA,oBAAAwD,KAAA,oBAGAsP,aAAA,SAAAU,GACA,GAAAC,IACAlB,UAAA,qBACAmB,SAAA,uBAGA,OAAArQ,MAAAgQ,gBAAAnS,KAAAuS,EAAAD,KAGAT,mBAAA,SAAAT,EAAAqB,GACA,IAAArB,EACA,OAAA,CAGA,IAAAsB,GAAA5T,EAAA,0CACA6T,OAAA,SAAAjF,EAAAkF,GACA,MAAA9T,GAAA8T,GAAAtQ,KAAA,gBAAAnD,OAAA,IAGA0T,EAAAH,EAAAtG,IAAA,SAAA0G,EAAAF,GACA,OACAA,KAAA9T,EAAA8T,GACAG,aAAAjU,EAAA8T,GAAAtQ,KAAA,mBAEA0Q,UAEAC,EAAA/G,EAAAlM,KAAA6S,GAAAE,eAAAhB,WAAAX,EAAA8B,aAEA,IAAAD,EAAA,CACA,GAAAnB,GAAAmB,EAAAL,IACA,IAAAH,EACA,MAAAA,GAAAX,EAAAV,EAAA8B,eAGA,IAAAT,EACA,MAAAA,GAAA,OAKAT,qBAAA,SAAAN,EAAA9M,EAAA6N,GACA,GACApB,IAAA,EACA3M,EAAA5F,EAAA,wCAAAwD,KAAA,UAEAxD,GAAAuH,MACAC,IAAA/H,OAAAqN,UAAA,gBAAA8F,EAAA,iCAAA9M,EACA4B,OAAA,MACAC,SACAC,cAAA,eAAAhC,KAEAiC,QAAA,SAAArE,GACA+O,EAAA/O,EAAA6Q,mBAAA,GAAA9B,UAEAoB,EAAApB,MAKAG,iBAAA,WACA,GAAAtP,GAAAC,IAEA,KAAAD,EAAAkR,uBAAA,CACAlR,EAAAkR,wBAAA,CACA,IAAAC,GAAA,kCACAC,EAAA,uDAEAxU,GAAAF,UAAAwB,GAAA,kBAAA,SAAA4B,GACA,GAAAuR,GAAAhV,OAAAiV,SAAAC,SACAC,EAAAJ,EAAAK,KAAAJ,EAEA,KAAAF,EAAAM,KAAAJ,IAAAG,KACAxR,EAAAgQ,UAAAzR,YAAA,UAEAiT,GAAA,CACA,GAAAE,GAAAL,EAAAM,MAAA,KACA9B,EAAA6B,EAAAA,EAAAzU,OAAA,EAEAL,GAAA,YAAAiT,EAAA,eAAAvR,SAAA,eAOA+B,WAAA,WACA,GAAAL,GAAAC,IAEAD,GAAAgQ,UAAAlS,KAAA,KAAAI,GAAA,QAAA,SAAA4B,GACAA,EAAAgI,iBACAxL,IAAA6C,WAAAyS,aAAA,KAAAhV,EAAAqD,MAAAkB,QAAA,kBAGAnB,EAAAyO,aAAAvQ,GAAA,QAAA,UAAA,SAAA4B,IACAlD,EAAAkD,EAAA+R,QAAAxT,SAAA,WAAAzB,EAAAkD,EAAA+R,QAAArR,SAAAnC,SAAA,aAIAyB,EAAAgS,kBAEA9R,EAAA+R,aAAAnV,EAAAqD,UAGAD,EAAAyO,aAAArO,KAAA,aAAA,GAEAJ,EAAAkQ,eAAAhS,GAAA,QAAA+B,KAAA+R,gBAGAC,cAAA,SAAAC,GACA,GAAAC,GAAA,EAEA,IAAA,eAAAD,EAAA9B,MAAA8B,EAAAE,SACA,OAAAF,EAAAE,SAAAhC,MACA,IAAA,OACA+B,EAAA,SACA,MAEA,KAAA,aACAA,EAAA,sBACA,MAEA,KAAA,0BACAA,EAAA,aACA,MAEA,SACAA,EAAA,kBAGA,IAAAD,EAAAG,MACA,OAAAH,EAAAG,MAAAjC,MACA,IAAA,QACA+B,EAAA,kBACA,MAEA,KAAA,QACAA,EAAA,iBACA,MAEA,KAAA,QACAA,EAAA,YACA,MAEA,KAAA,WACAA,EAAA,UACA,MAEA,KAAA,QACAA,EAAA,cACA,MAEA,KAAA,OACAA,EAAA,UACA,MAEA,KAAA,aACAA,EAAA,mBACA,MAEA,KAAA,aACAA,EAAA,WACA,MAEA,KAAA,eACAA,EAAA,aACA,MAEA,KAAA,OACAA,EAAA,UACA,MAEA,KAAA,QACAA,EAAA,WACA,MAEA,SACAA,EAAA,mBAMA,MAAAA,IAGAG,eAAA,SAAAC,GACA,GAAAvS,GAAAC,KAEAuP,EAAAxP,EAAA2O,WAAAjM,GACA8P,EAAAxS,EAAA0O,OAAAhM,GAEA2O,EAAA7B,EAAA,gBAAAA,EAAA,aAGA,OAFA6B,GAAAA,EAAA,YAAAmB,EAAA,oBAAAD,EAAA7P,IAKA+P,uBAAA,SAAAF,GACA,GAAAvS,GAAAC,IACA,OAAAD,GAAAsS,eAAAC,GAAA,aAGAG,wBAAA,SAAAR,GACA,GAAAS,GAAAT,EAAAU,WACAC,EAAAX,EAAAY,aAEA,KAAAH,IAAAE,EACA,OAAA,CAGA,IAAAE,GAAAtK,OAAAxI,KAAA0O,WAAAqE,cAEAC,EAAAN,EAAAlK,OAAAkK,GAAAI,EAAAG,IAAAL,EAAA,OAEA,OAAApK,UAAAwK,GAGAE,iBAAA,SAAA/C,EAAA1N,GACA,GAAA0Q,GAAAxW,EAAA,wBACA+R,EAAAyE,EAAAhT,KAAA,cACAiT,EAAA,SAAAjD,EAAA,OAEAkD,EAAA3E,GAAAA,EAAA2E,eACAC,EAAAH,EAAAhT,KAAA,mBAAAgT,EAAAhT,KAAA,kBAAAoT,iBACAC,EAAAF,GAAAD,GAAAC,EAAAD,EAEA,SAAAG,IAAAA,EAAAC,eAAAL,QAIA1E,IAAAA,EAAA,mBAIA4E,IAAAE,EAAAJ,KACAI,EAAAJ,GAAA7M,QAAA9D,SAMAiR,aAAA,SAAAlT,GACA,GAAAT,GAAAC,KACAyC,EAAAjC,EAAAL,KAAA,MACAwT,EAAAnT,EAAAL,KAAA,SACAyT,EAAApT,EAAA3C,KAAA,eAAA8C,OAEA,OAAAhE,GAAAuH,MACAC,IAAA/H,OAAAqN,UAAA,mBAAAhH,EACA4B,OAAA,MACAC,SACAC,cAAA,eAAAxE,EAAAwC,QAEAiC,QAAA,SAAAqP,GACA,GAAAC,GAAA/J,EAAAC,OAAA6J,EAAAE,eAAA,QAEAD,GAAA/J,EAAAyG,OAAAsD,EAAA,SAAAE,GACA,GAAAC,GAAAlK,EAAAlM,KAAAkC,EAAAmU,YAAAzR,GAAAuR,EAAAvR,IACA,OAAAwR,GAAAE,aAAA,IAAAF,EAAAG,mBAAApX,OAAA,GAAAiX,EAAAF,eAAA/W,OAAA,IAGA,IAAAqX,GAAAtK,EAAAE,IAAA6J,EAAA,SAAAG,GACA,MAAAtX,GACA,+CACAsX,EAAAxR,GAAA,iBACAkR,EAAA,GAAA,gDAEAM,EAAA5L,KAAA,6CAKAuL,GAAA5K,OAAAqL,OAKAC,cAAA,SAAA9T,GACA,GAAAT,GAAAC,KACAyC,EAAAjC,EAAAL,KAAA,MAEAyT,GADApT,EAAAL,KAAA,SACAK,EAAA3C,KAAA,eAAA8C,QAEA,OAAAhE,GAAAuH,MACAC,IAAA/H,OAAAqN,UAAA,mBAAAhH,EAAA,mBACA4B,OAAA,MACAC,SACAC,cAAA,eAAAxE,EAAAwC,QAEAiC,QAAA,SAAAqP,GACA,GAAAU,GAAAxK,EAAAyG,OAAAqD,EAAAW,gBAAA,SAAAvC,GACA,MAAAA,GAAAkC,aAAA,GAGAI,GAAAxK,EAAAC,OAAAuK,EAAA,SAEAxU,EAAA2O,aACA6F,EAAAxK,EAAAE,IAAAsK,EAAA,SAAAjC,GAEA,MADAA,GAAApD,UAAAnP,EAAA2O,WAAA+F,cAAA1U,EAAA2O,WAAA+F,aAAAvF,UAAA3I,QAAA+L,EAAAL,OAAAxP,OACA6P,IAIA,IAAAoC,GAAA3K,EAAAE,IAAAsK,EAAA,SAAAjC,GACA,GAAAqC,GAAA5U,EAAAgP,kBAAAuD,EAAAL,OAAAxP,GAAA,YAAA,GACAwP,EAAAK,EAAAL,OACAC,EAAAnS,EAAAiS,cAAAC,GACA2C,EAAA,OACAC,EAAA,OACAC,EAAA,KACAC,EAAA,KACAC,EAAA,KACA3E,EAAA,KACAO,EAAA0B,EAAA1B,aACAuD,GAAA,EACAc,EAAArE,EAAA3G,IAAA,SAAAwG,GACA,MAAAA,GAAAb,YAGA7P,GAAA2O,aACAoG,EAAA/U,EAAA0S,wBAAAR,GAEAlS,EAAA2O,WAAA+F,cAAA1U,EAAA2O,WAAA+F,aAAAvF,UAAA3I,QAAA0L,EAAAxP,QACAmS,EAAA,OACAC,EAAA,MAEA9U,EAAA2O,WAAA+F,cAAA1U,EAAA2O,WAAA+F,aAAAS,YAAA3O,QAAA0L,EAAAxP,QACAmS,EAAA,KACAC,EAAA,SAEAD,EAAA,OACAC,EAAA,QAIA5C,EAAAU,YACAoC,EAAA,aACAC,EAAA/C,EAAAU,YACAV,EAAAY,gBACAkC,EAAA,gBACAC,EAAAxM,OAAAzI,EAAA2O,WAAAqE,cAAAE,IAAAhB,EAAAY,cAAA,SAGA9S,EAAA8O,gBACAwB,EAAAtG,EAAAlM,KAAAkC,EAAA2O,WAAAsC,oBAAAD,UAAAkB,EAAAxP,OAIA1C,EAAA2O,YACA3E,EAAA9M,KAAAgY,EAAA,SAAAxS,GACA,GAAAqO,GAAA/G,EAAAlM,KAAA0W,GAAA3E,WAAAnN,EAAAyM,WAAA,GAEA4B,KACAqD,GAAA,KAKA7B,EAAApD,WACAvS,EAAA,oBAAA2B,YAAA,WAGA,IAAA0J,GAAA,2FAAA2M,IAAAR,GAAApU,EAAA2O,YAAA3O,EAAAmT,iBAAA,UAAAZ,EAAA7P,IAAA,WAAA,IAAA,iBACA6P,EAAA7P,GAAA,yBACA0S,KAAAC,UAAAxE,GAAA,cACA0B,EAAAL,OAAAxP,GAAA,mCAEAwP,EAAAxP,GAAA,qCAAAkS,GAAAG,EAAA,GAAA,iBAAA,qBAAA7C,EAAAxP,GAAA,yDAGAyP,EAAA,oCAGAnS,EAAA8O,eAAAiG,EACA,iCAAA/U,EAAAsS,eAAAC,GAAA,WAAAL,EAAAoD,MAAA,cACA,qDAAApD,EAAAoD,MAAA,kBACA,8BAGAlB,GAAApU,EAAA2O,YAAA3O,EAAAmT,iBAAA,UAAAZ,EAAA7P,IAAA,4BAAA,IACA,wFACAoS,EAAA,kDACAD,EAAA,eAGA,IAAA7U,EAAA8O,cAAA,CACA,GAAAwB,GAAAA,EAAAiF,OAAAvV,EAAA2O,WAAA6G,uBAAA,YAAAxV,EAAA2O,WAAA8G,oBAAA,CACA,GAAAC,GAAA1V,EAAAiP,aAAA,+BAEAyG,GAAAA,EAAAhP,QAAA,uBAAA4J,EAAAiF,OACAG,EAAAA,EAAAhP,QAAA,yCAAA1G,EAAA2O,WAAA6G,uBAEAvN,GAAA,iEAAAyN,EAAA,+DACApF,EAAAiF,MAAA,IAAAvV,EAAA2O,WAAA6G,sBAAA,iBAIA,IAAAT,EAAA,CACA,GAAAY,GAAAlN,OAAAmN,GAAAC,OACA5N,IAAA,oCAAAjI,EAAAiP,aAAA,UAAA+F,GAAA,UAAAvM,OAAAmN,GAAAX,EAAAU,GAAA3M,OAAA,cAAA,iBAGAhJ,EAAA+O,gBAAAwD,EAAAuD,eACA7N,GAAA,kCAAAjI,EAAAyS,uBAAAF,GAAA,+DAUA,MAJAtK,IAAA,oBAIArL,EAAAqL,IAIA4L,GAAA5K,OAAA0L,GACA3U,EAAA+V,8BAMAA,wBAAA,WACA,GAAA7G,GAAAjP,KAAAiP,gBAEA5S,KAAA6C,WAAAwQ,mBAAAT,EAAA,SAAAU,EAAAC,GACA,GAAAD,GAAAC,EAAA,CACA,IAAAA,IAAAX,EAAAwE,eAAA,iBACA,MAGApX,KAAA6C,WAAA2Q,qBAAAZ,EAAAO,cAAAI,EAAA,SAAAV,GACAA,IACAvS,EAAA,oBAAA2B,YAAA,YACAqR,EAAArR,YAAA,WACAqR,EAAA9R,KAAA,uBAAAuJ,gBAKAzK,GAAA,oBAAA2B,YAAA,eAKA8Q,eAAA,WACA,GAAArP,GAAAC,IAEAD,GAAA0O,QAEA9R,EAAAuH,MACAC,IAAA/H,OAAAqN,UAAA,YAAA1J,EAAA0O,OAAAhM,GAAA,kBACA4B,OAAA,MACAC,SACAC,cAAA,eAAAxE,EAAAwC,QAEAiC,QAAA,SAAAqP,GACA,GAAAA,EAAAE,kBAAAF,EAAAE,eAAA/W,QAAA,GAAA,CAEA+C,EAAAmU,WAAAL,EAAAE,eAEAhU,EAAAgW,WAAAhM,EAAAyG,OAAAqD,EAAAE,eAAA,SAAAiC,GACA,OAAAA,EAAAC,sBAAAD,EAAA7B,aAAA,IACA6B,EAAA5B,mBAAApX,OAAA,GAAAgZ,EAAAjC,eAAA/W,OAAA,KAGA+C,EAAAgW,WAAAhM,EAAAC,OAAAjK,EAAAgW,WAAA,QAEA,IAAA1B,GAAAtK,EAAAE,IAAAlK,EAAAgW,WAAA,SAAA9B,GACA,GAAAiC,GAAAnW,EAAA2O,YAAA3O,EAAAmT,iBAAA,SAAAe,EAAAxR,GAEA,OAAA9F,GACA,sCAAAuZ,EAAA,WAAA,IAAA,cACAjC,EAAAxR,GAAA,8DAGAwR,EAAA5L,KAAA,6CAKAtI,GAAAyO,aAAA2H,KAAA,wBAAAC,QAAA,OAAA,WACArW,EAAAyO,aAAAf,IAAA,UAAA,QACA1N,EAAAyO,aAAAxG,KAAAqM,GACAtU,EAAAyO,aAAA6H,OAAA,QAEAtW,EAAA4O,eACA5O,EAAAuW,oBAAAvW,EAAA4O,cAAA4H,4BAOAzE,aAAA,SAAAvR,EAAA+P,GACA,GAAAvQ,GAAAC,KACAQ,EAAA7D,EAAA4D,GAIAqT,GAFApT,EAAAL,KAAA,MACAK,EAAAL,KAAA,SACAK,EAAA3C,KAAA,eAAA8C,QAEAiT,GAAA5W,QAAA,GACAwD,EAAA3C,KAAA,SAAA4P,KAAA+I,QAAA,IACA5C,EAAAjX,EAAA,uDACAiX,EAAA6C,SAAAjW,GAEA7D,EAAA+Z,KAAA3W,EAAA2T,aAAAlT,GAAAT,EAAAuU,cAAA9T,IACAoE,KAAA,WACApE,EAAAnC,SAAA,YACAmC,EAAA3C,KAAA,SAAA4P,KAAA+I,QAAA,IAEA5C,EAAA+C,UAAA,QAEA,kBAAArG,IACAA,QAIA9P,EAAApC,SAAA,aACAoC,EAAAlC,YAAA,YACAsV,EAAAgD,QAAA,UAEApW,EAAAnC,SAAA,YACAuV,EAAA+C,UAAA,SAGA,kBAAArG,IACAA,MAKAnB,cAAA,WACAxS,EAAAF,UAAAwB,GAAA,yBAAA,SAAA4B,GAEA,GAAAA,EAAAgX,eAAAhX,EAAAgX,cAAA1W,MAAA,GAAAN,EAAAgX,cAAA1W,KAAAnD,OAAA,CAEA,GAAA8K,GAAAnL,EAAAkD,EAAAgX,cAAA1W,KAAA,GACA9D,KAAA6C,WAAA6Q,UAAA9S,KAAA,SAAAC,EAAAoK,GACA,GAAAC,GAAA5K,EAAA2K,GACAwP,EAAAhP,EAAAjK,KAAA,IAAA0J,EAAAlK,KAAA,MACAkK,GAAAS,KAAA8O,EAAA9O,cAKA2J,aAAA,SAAAoF,EAAA9E,GACA,GAAA+E,GAAAra,EAAAsV,EAEA,IAAA,SAAA8E,EAAA,CACA,GAAAE,GAAA5a,IAAA6C,WACA8Q,gBACAkH,QAAA,cAEAD,GAAAja,OAAA,GAAAia,EAAApZ,KAAA,KAAAb,OAAA,IACAga,EAAAra,EAAAsa,EAAA,SACA,IAAA,SAAAF,EAAA,CACA,GAAAI,GAAA9a,IAAA6C,WACA8Q,gBACAoH,QAAA,cAEAD,GAAAna,OAAA,GAAAma,EAAAtZ,KAAA,KAAAb,OAAA,IACAga,EAAAra,EAAAwa,EAAA,KAGAH,EAAAnZ,KAAA,KAAA,GAAAkN,SAGAuL,oBAAA,SAAAe,GACA,GAAAtX,GAAAC,KAEA8T,KACAwD,EAAAD,EAAAE,aAGA,KAFAzD,EAAA1L,KAAAkP,EAAA7U,IAEA6U,EAAAE,eACAF,EAAAA,EAAAE,cACA1D,EAAA1L,KAAAkP,EAAA7U,GAGAqR,GAAAA,EAAA2D,UAEAC,MAAAC,WAAA7D,EAAA,SAAA8D,EAAAtH,GACA,GAAAuH,GAAAlb,EAAA,oBAAAib,EAAA,KACA7X,GAAA+R,aAAA+F,EAAAvH,MAKAyB,cAAA,WACA1V,IAAA6C,WAAA+Q,eAAAjP,YAAA,UACA3E,IAAA6C,WAAAgR,kBAAAlP,YAAA,eClrBA,WAGA3E,IAAAqD,WAAA,WACA,GAAAoY,GAAA,gEACAC,EAAA,iBAEAC,EAAA,SAAAC,GACA,MAAAH,GAAAtG,KAAAyG,IAGAC,EAAA,SAAAD,GACA,MAAAF,GAAAvG,KAAAyG,GAGAtb,GAAAF,UAAA0b,YAAA,SAAA1a,EAAA2a,EAAAC,GACA,GAAAL,EAAAK,EAAAlU,MAAA+T,EAAAG,EAAAlU,KAAA,CACA,GAAA8K,GAAA5S,IAAA6C,WAAA+P,gBAEA5S,KAAA6C,WAAAwQ,mBAAAT,EAAA,SAAAU,EAAAC,GACAA,GAAAX,EAAAO,eACAnT,IAAA6C,WAAA2Q,qBAAAZ,EAAAO,cAAAI,EAAA,SAAAV,GACA,GAAAA,EAAA,CACA,GAAAoJ,GAAAjc,IAAA6C,WAAA8Q,gBAAAnS,KAAA,uBACAya,GAAAha,YAAA,cACAga,EAAAha,YAAA,uBACAga,EAAAja,SAAA,wBACAia,EAAAja,SAAA,cAEA1B,EAAA,oBAAA2B,YAAA,YACAqR,EAAArR,YAAA,YACAqR,EAAArR,YAAA,WACAqR,EAAA9R,KAAA,uBAAAuJ,aAIA,WACAzK,EAAA,oBAAA2B,YAAA,qBCrCA,WAGAjC,IAAAsC,UAAA,WACA,GAAA4Z,GAAA,SAAAjT,GACA,MAAA,MAAAA,EAAAmB,QAAA,MAAA,IAAAzJ,OAAA,kBAAA,mBAGAwb,GACAC,WAAA,SAAAnT,EAAAzF,EAAA6Y,EAAAC,GACAD,EAAAE,KAAAL,EAAAM,SAAAC,WAAAH,IAIAhc,GAAA,eAAAic,KAAAL,EAAAC,GACA7b,EAAA,aAAAic,KAAA,kBACAjc,EAAA,aAAAic,KAAA,cAEAjc,EAAAF,UAAAI,QAAA,sBClBAR,IAAAgD,SACA+B,KAAA,EAEA2X,cAAA,WACA,MAAApc,GAAA,uBAGAe,KAAA,WACA,MAAAf,GAAA,qBAGAqc,SAAA,SAAAjI,EAAAT,GACA3T,EAAAuH,MACAC,IAAA/H,OAAAiV,SAAAC,SAAA,YACAjN,OAAA,MACAG,QAAA,WACA,kBAAA8L,IACAA,QAMA2I,SAAA,SAAA3I,GACA,GAAA4I,GAAAvc,EAAA,YAAAqL,OACAmR,EAAAxc,EAAA,eAAA2I,MAEA8T,EAAAzc,EAAA,wBACA0c,EAAAD,EAAApR,MACAoR,GAAApR,KAAAoR,EAAAjZ,KAAA,YACAiZ,EAAAE,KAAA,YAAA,GAEA3c,EAAAuH,MACAC,IAAA/H,OAAAiV,SAAAC,SAAA,YACAjN,OAAA,OACAlE,MACAoZ,IAAAJ,EACAD,KAAAA,GAEA1U,QAAA,WACA4U,EAAApR,KAAAqR,GACAD,EAAAE,KAAA,YAAA,GACA,kBAAAhJ,IACAA,QAMAtS,KAAA,WACA,GAAA+B,GAAAC,IACAA,MAAA+Y,gBAAA/b,QAAA,IACAgD,KAAAgZ,SAAArc,EAAA,cAAA2I,OAEA3I,EAAA,iBAAAsB,GAAA,SAAA,SAAAR,GACAA,EAAAoK,iBACA9H,EAAAkZ,gBCxDA,WAGA5c,IAAAkC,SACAib,gBAAA,WACA,GAAAC,GAAA,GAAAC,SAAAD,WACAE,EAAAhd,EAAA,+BAAA2I,MAAAoM,MAAA,IAQA,OANA+H,GAAAG,oBAAAjP,SAAAgP,EAAA,IACAF,EAAAI,mBAAAlP,SAAAgP,EAAA,IACAF,EAAAK,eAAAnd,EAAA,gCAAA2I,MACAmU,EAAAM,WAAApd,EAAA,2BAAA2I,MACAmU,EAAAO,QAAArd,EAAA,wBAAA2I,MAEAmU,GAGAQ,yBAAA,SAAAC,GACA,GAAAT,GAAApd,IAAAkC,QAAAib,kBACAW,EAAAV,EAAAU,cACAC,GAAA,CACA,KAAA,GAAA1B,KAAAyB,GAAA,CAAAC,GAAA,CAAA,OAEApV,QAAAqV,IAAA,GACAje,OAAAke,eAAAb,EAEAW,GACAhe,OAAA+d,YAAAA,EAEAnV,QAAAqV,IAAAje,OAAA+d,cAEAV,EAAAc,aAAA,SAAAC,GACA7d,EAAA,cAAA2I,IAAAkV,GAEAN,EAAAxS,IAAA,GAAA+S,YAKAzc,KAAA,WACA,GAAAkN,GAAA,4CACAgP,EAAAvd,EAAA,cACA+d,EAAA/d,EAAA,YAAA2I,KAEA4U,GAAAld,QAAA0d,GACAvP,UAAA,UAAAD,EAAA,WACAwO,QAAAiB,eAAAD,EAEAR,EAAAO,OAAA,SAAAhd,GACAA,EAAAoK,iBAEAxL,IAAAkC,QAAA0b,yBAAAC,KAGAvd,EAAAF,UAAAI,QAAA,2BCtDA,WAGAR,IAAAsD,cAAA,WACAhD,EAAAF,UAAAwB,GAAA,QAAA,gBAAA,WACA,GAAA2c,GAAAje,EAAAqD,MAAAkB,QAAA,WAEA0Z,GAAA/c,KAAA,iBAAAQ,SAAA,UACAuc,EAAA/c,KAAA,iBAAAS,YAAA,YAGA3B,EAAAF,UAAAwB,GAAA,QAAA,kBAAA,SAAA4B,GACA,GAAA+a,GAAAje,EAAAqD,MAAAkB,QAAA,WAEA0Z,GAAA/c,KAAA,iBAAAS,YAAA,UACAsc,EAAA/c,KAAA,iBAAAQ,SAAA,YAGA1B,EAAAF,UAAAI,QAAA,gCClBA,WAGAR,IAAAqC,YAAA,WAEA/B,EAAA,qBAAAsB,GAAA,QAAA,SAAA4B,GACAA,EAAAgI,gBAEA,IAAAN,GAAA5K,EAAAqD,MACA4R,EAAArK,EAAAlK,KAAA,QAAAoJ,QAAA,IAAA,IACAoU,EAAAle,EAAA,iCAAAiV,EAAA,KAEAjV,GAAA,qBAAA2B,YAAA,UACA3B,EAAA,uBAAA2B,YAAA,UAEAiJ,EAAAlJ,SAAA,UACAwc,EAAAxc,SAAA,YAGA1B,EAAA,2BAAAoO,YCnBA,WAGA1O,IAAAuC,aAAA,WACAjC,EAAA,qBAAAM,KAAA,SAAAC,EAAAoK,GACA,GAAAwT,GAAAne,EAAA2K,GAAAnH,KAAA,UAAA,IACA4a,EAAApe,EAAA2K,GAAAnH,KAAA,qBAAA,IACA6a,EAAAre,EAAA2K,GAAAnH,KAAA,cAAA,YACA8a,EAAAte,EAAA2K,GAAAnH,KAAA,cAAA,SAEA+a,EAAAve,EAAA2K,GAAA6T,cACAC,EAAAF,GAAAH,CAEApe,GAAA2K,GAAA+T,UACAP,MAAAA,EACAC,gBAAAA,EACAO,SAAA,uBAAAF,EAAA,SAAA,iBAAA,KAAAJ,EAAA,OACAO,SAAA,uBAAAH,EAAA,SAAA,iBAAA,KAAAH,EAAA,eCjBA,WAGA5e,IAAA6G,cAEAsY,eAAA,SAAAC,EAAAjS,GACA,GAAAkS,GAAAC,UAAAC,SAAAC,cAAAtV,QAAA,QAAA,EAEAuV,EAAA,SAAAjc,GACA,GAAAkc,GAAAC,OAAAC,aAAApc,EAAAiD,SACAoZ,EAAArc,EAAAsc,QACAC,IAAAvc,EAAAwc,QACAC,EAAA,CAYA,IAVAZ,GAAAU,EACAE,IACAJ,GACAI,IAGAP,GAAAN,GACAa,IAGA,GAAAA,EAGA,MAFAzc,GAAAgS,kBACAhS,EAAAgI,iBACA2B,IAKA7M,GAAA,QAAAoK,KAAA,UAAA+U,IAGAS,WAAA,SAAA1c,GACAA,EAAAgS,kBACAhS,EAAAgI,kBAGA2U,WAAA,SAAA3c,GACAA,EAAAgS,kBACAhS,EAAAgI,gBACA,IAAAmO,GAAAnW,EAAA4c,QACAC,EAAA7c,EAAA8c,QACAC,EAAA/c,EAAAgd,aAAAC,MAAA,GAEAC,EAAA3gB,OAAA4gB,KAAA5gB,OAAA6gB,UACAC,EAAAH,EAAAI,gBAAAP,EAEA,IAAAA,EAAAzM,KAAAiN,MAAA,WAAA,CAEA,GAAAC,GAAA5gB,SAAA6gB,cAAA,MAEAD,GAAAnS,IAAAgS,CAEA,IAAAK,GAAA,IAEA,IAAA9gB,SAAA+gB,uBAAA;AACA,GAAAC,GAAAhhB,SAAA+gB,uBAAAxH,EAAA0G,EACAa,GAAA9gB,SAAAihB,cACAH,EAAAI,SAAAF,EAAAG,WAAAH,EAAAtQ,QACAoQ,EAAAM,WACAN,EAAAO,WAAAT,OACA5gB,UAAAshB,sBACAR,EAAA9gB,SAAAshB,oBAAA/H,EAAA0G,GACAa,EAAAO,WAAAT,MAKAW,cAAA,WACA,GAAAC,GAAAxhB,SAAAyhB,kBAAA,QACAC,EAAA1hB,SAAAyhB,kBAAA,UACAE,EAAA3hB,SAAAyhB,kBAAA,YAEAD,MAAA,EACAthB,EAAA,sBAAA0B,SAAA,UAEA1B,EAAA,sBAAA2B,YAAA,UAGA6f,KAAA,EACAxhB,EAAA,wBAAA0B,SAAA,UAEA1B,EAAA,wBAAA2B,YAAA,UAGA8f,KAAA,EACAzhB,EAAA,2BAAA0B,SAAA,UAEA1B,EAAA,2BAAA2B,YAAA,WAIAN,KAAA,SAAAqgB,GACAre,KAAAse,WAAA3hB,EAAA0hB,GAEAre,KAAAue,OAAAve,KAAAse,WAAAzgB,KAAA,aACAmC,KAAAwe,WAAAxe,KAAAse,WAAAzgB,KAAA,kBAEAmC,KAAAye,mBACAze,KAAA0e,mBACA1e,KAAA2e,qBAGAF,iBAAA,WACA,GAAA1e,GAAAC,IAEAD,GAAAye,WAAAvgB,GAAA,QAAA,WACA,GAAA2gB,GAAAjiB,EAAAqD,MAAA3C,KAAA,cACAZ,UAAAoiB,YAAAD,GACAviB,IAAA6G,aAAA8a,kBAGAje,EAAAwe,OAAAtgB,GAAA,QAAA,WACA5B,IAAA6G,aAAA8a,kBAGAje,EAAAwe,OAAAtgB,GAAA,UAAA,WACA8B,EAAAue,WAAAjgB,SAAA,aAGA0B,EAAAwe,OAAAtgB,GAAA,WAAA,WACA8B,EAAAue,WAAAhgB,YAAA,cAIAogB,iBAAA,WACA,GAAAI,GAAAniB,EAAAqD,KAAAqe,WAAAxgB,KAAA,YACAihB,GAAA7gB,GAAA,WAAA5B,IAAA6G,aAAAqZ,YAAA,GACAuC,EAAA7gB,GAAA,OAAA5B,IAAA6G,aAAAsZ,YAAA,IAGAmC,kBAAA,WAEAtiB,IAAA6G,aAAAsY,eAAA,IAAA,WACA/e,SAAAoiB,YAAA,aACAxiB,IAAA6G,aAAA8a,kBAGA3hB,IAAA6G,aAAAsY,eAAA,IAAA,WACA/e,SAAAoiB,YAAA,QACAxiB,IAAA6G,aAAA8a,kBAGA3hB,IAAA6G,aAAAsY,eAAA,IAAA,WACA/e,SAAAoiB,YAAA,UACAxiB,IAAA6G,aAAA8a,uBCpJA3hB,IAAA+C,eACAgC,KAAA,EAEA2d,gBAAA,WACA,MAAApiB,GAAA,yBAGAe,KAAA,WACA,MAAAf,GAAA,4BAGAqiB,aAAA,WACA,MAAAriB,GAAA,mCAGAsiB,WAAA,WACA,MAAAtiB,GAAA,iCAGAuiB,eAAA,WACA,MAAAviB,GAAA,yBAGAwiB,WAAA,SAAA7O,GACA,GAAAvQ,GAAAC,IAEArD,GAAAuH,MACAC,IAAA/H,OAAAiV,SAAAC,SAAA,wBAAAvR,EAAAqB,KACAiD,OAAA,MACAlE,MACAif,SAAA,GAEAC,SAAA,WACA,kBAAA/O,IACAA,QAMAtS,KAAA,WACA,GAAA+B,GAAAC,IAEAD,GAAAgf,kBAAA/hB,QAAA,IAEA+C,EAAAif,eAAA/gB,GAAA,QAAA,WACA8B,EAAAif,eAAAM,OACAvf,EAAArC,OAAAiZ,UAAA,UAGA5W,EAAAkf,aAAAhhB,GAAA,QAAA,WACA8B,EAAArC,OAAAkZ,QAAA,OAAA,WACA7W,EAAAif,eAAA3I,OAAA,YAIAtW,EAAAmf,iBAAAjhB,GAAA,QAAA,WACA8B,EAAAqB,KAAArB,EAAAqB,KAAA,CACA,IAAAme,GAAA5iB,EAAAqD,KAEAuf,GAAAliB,KAAA,WAAA,YACA0C,EAAAof,WAAA,WACAI,EAAAxhB,WAAA,gBAIAgC,EAAAof,gBClEA,WAGA9iB,IAAAmD,eAAA,WACA7C,EAAA,0BAAAM,KAAA,SAAAC,EAAAoK,GACA,GAAAC,GAAA5K,EAAA2K,GACAyB,EAAAxB,EAAApH,KAAA,UACAuV,EAAAlN,OAAAmN,GAAAC,QACA4J,EAAAjY,EAAApH,KAAA,WAEAoH,GAAAS,KAAAQ,OAAAmN,GAAA6J,EAAA9J,GAAA3M,OAAAA,MAGApM,EAAAF,UAAAI,QAAA,wBAKAR,IAAAmD,oBClBA,WACA7C,EAAAF,UAAAwB,GAAA,YAAA,WACA5B,IAAA2B,SAGArB,EAAAF,UAAAwB,GAAA,oBAAA,WACA5B,IAAAmC,cAGA7B,EAAAF,UAAAgjB,MAAA,WACApjB,IAAA2B","file":"theme.base.min.js","sourcesContent":["'use strict';\n\n(function () {\n  'use strict';\n\n  window.app = {\n    bindGlobal: function bindGlobal() {\n      FastClick.attach(document.body);\n\n      $('.timeago').timeago();\n\n      $(document).trigger('app:bind:global');\n    },\n\n    bindOpenOnLoad: function bindOpenOnLoad() {\n      var toOpen = $('.js-open-on-load');\n      if (toOpen.length > 0) {\n        $.each(toOpen, function (i, elem) {\n          window.open($(elem).attr('href'));\n        });\n      }\n\n      $(document).trigger('app:bind:open_on_load');\n    },\n\n    bindTooltips: function bindTooltips() {\n      $(\"[data-toggle='tooltip']\").tooltip(\"destroy\").tooltip();\n\n      $(document).trigger('app:bind:tooltips');\n    },\n\n    checkFormValidity: function checkFormValidity(event) {\n      var form = event.currentTarget;\n      var submitButton = $(form).find('button[type=\"submit\"]');\n\n      if (form.checkValidity()) {\n        submitButton.removeAttr('disabled');\n      } else {\n        submitButton.attr('disabled', 'disabled');\n      }\n\n      $(document).trigger('app:bind:check_form_validity');\n    },\n\n    init: function init() {\n      $(document).on('scroll', function () {\n        var scrollTop = $(document).scrollTop();\n        var $body = $('body');\n\n        if (scrollTop > 0 && !$body.hasClass('scrolled')) {\n          $body.addClass('scrolled');\n        } else if (scrollTop <= 0 && $body.hasClass('scrolled')) {\n          $body.removeClass('scrolled');\n        }\n      });\n\n      app.pagarme.init();\n      app.bindGlobal();\n      app.bindBlazy();\n      app.bindOpenOnLoad();\n      app.bindHome();\n      app.bindProduct();\n      app.bindMasks();\n      app.bindTooltips();\n      app.bindReadMore();\n      app.bindDatepicker();\n      app.bindFixOnScroll();\n      app.ckeditor.bindCkeditor();\n      app.bindCheckout();\n      app.lessonList.init();\n      app.chat.init();\n      app.studentDoubts.init();\n      app.notepad.init();\n      app.categoryList.init();\n      app.bindExamQuestionForm();\n      app.changeTimeZone();\n      app.followBind();\n      app.lessonPage();\n      app.bindPostsForm();\n\n      $(document).on('app:bind:ckeditor_submit', app.bindCollaborativeDiscussion);\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindBlazy = function (e) {\n    new Blazy();\n\n    $(document).trigger('app:bind:blazy');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.categoryList = {\n    init: function init() {\n      var self = this;\n      self.$categoryList = $('#js-category-list');\n\n      if (self.$categoryList.length == 0) return;\n\n      self.isActive = self.$categoryList.data('is-active') || self.isActive;\n\n      if (!self.isActive) {\n        self.bindClicks();\n        self.$categoryList.attr('data-is-active', true);\n        self.isActive = true;\n      }\n\n      self.expandParents();\n    },\n\n    bindClicks: function bindClicks() {\n      var self = this;\n\n      $(document).on('click', '#js-category-list .category-item .toggle-btn', function () {\n        self.expandParent($(this).parent('.category-item'), true);\n      });\n    },\n\n    expandParent: function expandParent($parent, animate) {\n      var $nextListGroup = $parent.find('.list-group').first();\n      var $parentCategoryItem = $parent;\n\n      if (animate) {\n        $nextListGroup.stop().slideToggle('fast');\n      } else {\n        $nextListGroup.stop().toggle();\n      }\n\n      $parentCategoryItem.toggleClass('expanded');\n    },\n\n    expandParents: function expandParents() {\n      var self = this;\n      var $loopItem = self.$categoryList.find('.category-item.current').first();\n\n      while ($loopItem) {\n        self.expandParent($loopItem, false);\n\n        var $parent = $loopItem.parents('.category-item').first();\n\n        if ($parent.length > 0) {\n          $loopItem = $parent;\n        } else {\n          $loopItem = null;\n        }\n      }\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.chat = {\n    groupsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n    collaboratorsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n    followsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n\n    init: function init() {\n      var self = this;\n\n      self.$chat = $('.js-chat');\n      self.$groups = $('.js-groups');\n      self.$roomTitle = $(\"#js-room-title\");\n      self.$roomUsersCount = $(\"#js-room-users-count\");\n      self.$text = $('.js-chat-text');\n      self.$messagesContainer = $('.js-chat-messages .js-content');\n      self.$messagesScroll = $('.js-chat-messages .js-scroll');\n      self.$sendForm = $('#js-send-messages');\n      self.$loadMoreGroupsButton = self.$chat.find('.js-load-more-groups');\n      self.$loadMoreCollaboratorsButton = self.$chat.find('.js-load-more-collaborators');\n      self.$loadMoreStudentsButton = self.$chat.find('.js-load-more-students');\n      self.$generalChatGroup = self.$chat.find('.js-chat-group-general');\n\n      self.user = $(\"#school-header\").data('user');\n\n      if (!self.user) {\n        return;\n      }\n\n      self.schoolId = self.$chat.data('school-id');\n      self.apiKey = self.$chat.data('api-key');\n      self.userId = self.user.id;\n\n      if (self.$chat.length <= 0) return;\n\n      self.bindScroll();\n\n      self.$messagesContainer.empty();\n\n      // bind form\n      self.$text.keyup(function (e) {\n        var code = e.keyCode ? e.keyCode : e.which;\n        if (code === 13 && !e.shiftKey) {\n          self.submitMessage(e);\n        }\n      });\n\n      app.simpleEditor.init('#js-send-messages');\n      self.$sendForm.on('submit', self.submitMessage);\n\n      firebase.initializeApp(window.CHAT_CONFIG);\n      self.database = firebase.database();\n\n      self.authenticate();\n\n      self.loadSchoolGroup(self.didLoadSchoolGroup);\n      self.loadGroups(self.didLoadGroups);\n      self.loadCollaborators(self.didLoadCollaborators);\n      self.loadFollows(self.didLoadFollows);\n\n      self.$loadMoreGroupsButton.on('click', function () {\n        self.loadGroups(self.didLoadGroups);\n      });\n\n      self.$loadMoreCollaboratorsButton.on('click', function () {\n        self.loadCollaborators(self.didLoadCollaborators);\n      });\n\n      self.$loadMoreStudentsButton.on('click', function () {\n        self.loadFollows(self.didLoadFollows);\n      });\n\n      self.$generalChatGroup.on('click', function () {\n        self.changeRoom({\n          currentTarget: self.$generalChatGroup\n        });\n      });\n\n      self.listenConnectionChanges();\n    },\n\n    authenticate: function authenticate() {\n      var self = app.chat;\n      $.ajax({\n        url: window.CHAT_FIREBASE_SERVICE_HOST + '/authenticate',\n        method: 'POST',\n        headers: {\n          'Authorization': self.apiKey\n        }\n      }).success(function (data) {\n        firebase.auth().signInWithCustomToken(data.body.firebase_token).then(function (response) {\n          self.monitorConnectionState(response);\n        }).catch(function (error) {\n          console.error(\"Error creating custom token:\", error);\n        });\n      }).error(function (error) {\n        console.error('Could not authenticate');\n        console.error(error);\n      });\n    },\n\n    monitorConnectionState: function monitorConnectionState(response) {\n      var self = app.chat;\n      var userRef = firebase.database().ref(\"user_status\").child(response.uid);\n\n      // Monitor connection state on browser tab\n      firebase.database().ref(\".info/connected\").on(\"value\", function (snap) {\n        if (snap.val()) {\n          // if we lose network then remove this user from the list\n          userRef.onDisconnect().set(\"offline\");\n          // set user's online status\n          userRef.set(\"online\");\n        }\n      });\n\n      document.onIdle = function () {\n        userRef.set(\"idle\");\n      };\n\n      document.onAway = function () {\n        userRef.set(\"away\");\n      };\n\n      document.onBack = function (isIdle, isAway) {\n        userRef.set(\"online\");\n      };\n    },\n\n    listenConnectionChanges: function listenConnectionChanges() {\n      var self = app.chat;\n      var connectionsRef = this.database.ref(\"user_status\");\n\n      connectionsRef.on('child_added', function (data) {\n        self.updateStatus(data.val(), data.key);\n      });\n\n      connectionsRef.on('child_changed', function (data) {\n        self.updateStatus(data.val(), data.key);\n      });\n\n      connectionsRef.on('child_removed', function (data) {\n        self.updateStatus(data.val(), 'offline');\n      });\n    },\n\n    updateStatus: function updateStatus(status, user_id) {\n      var $element = $('*[data-id=\"' + user_id + '\"]')[0];\n      if ($element) {\n        $('.status > .icon', $element).first().attr('class', 'icon icon-' + status);\n      }\n    },\n\n    bindScroll: function bindScroll() {\n      var height = this.$chat.data('height');\n      var parent = this.$chat.data('parent');\n      var parentHeight = parent ? $(parent).height() : $(window).height();\n      var isPercentHeight = height.indexOf('%') > -1;\n      height = Number(height.replace('%', '').replace('px', ''));\n\n      if (isPercentHeight === true) {\n        this.chatHeight = parentHeight / 100 * height;\n      } else {\n        this.chatHeight = height;\n      }\n\n      this.$chat.height(this.chatHeight);\n      this.$chat.find('.js-sidebar-scroll').scrollbar({});\n      this.$chat.find('.js-chat-messages .js-scroll').scrollbar({});\n    },\n\n    loadMessages: function loadMessages() {\n      var self = app.chat;\n      var setMessage = function (data) {\n        self.insertMessage(data.val());\n      }.bind(self);\n\n      self.messages.limitToLast(12).on('child_added', setMessage);\n      self.messages.limitToLast(12).on('child_changed', setMessage);\n    },\n\n    sanitizeHtml: function sanitizeHtml($root) {\n      $root.find('div:empty').remove();\n\n      // Removes elements with only '<br/>' children\n      $root.children().each(function (i, el) {\n        var $el = $(el);\n        if (el.tagName !== 'BR' && $el.find('br').length > 0 && $el.find('br').length == $el.children().length) {\n          $el.remove();\n        }\n      });\n\n      // Removes last '<br/>'\n      if ($root.last().get(0).tagName === 'BR') {\n        $root.last().remove();\n      }\n\n      return $root;\n    },\n\n    submitMessage: function submitMessage(event) {\n      event.preventDefault();\n      var self = app.chat;\n\n      var $html = self.sanitizeHtml(self.$text);\n      var text = $html.html();\n\n      if (text.length <= 0) return;\n\n      self.$text.html('').focus();\n\n      function pad(n) {\n        return n < 10 ? \"0\" + n : n;\n      }\n\n      var date = new Date();\n\n      self.messages.push({\n        id: self.user.id,\n        name: self.user.name,\n        avatar_url: self.user.avatar_url,\n        text: text,\n        timestamp: moment().unix(),\n        schedule: pad(date.getHours()) + ':' + pad(date.getMinutes())\n      });\n    },\n\n    insertMessage: function insertMessage(data) {\n      var self = app.chat;\n      var html = self.renderTemplate('chat-message', {\n        avatar: data.avatar_url,\n        name: data.name,\n        text: data.text,\n        schedule: moment.unix(data.timestamp).format('LLL')\n      });\n\n      self.$messagesContainer.append(html);\n      self.scrollToEnd();\n    },\n\n    scrollToEnd: function scrollToEnd() {\n      var self = this;\n      self.$messagesScroll.scrollTop(self.$messagesScroll[0].scrollHeight);\n    },\n\n    renderTemplate: function renderTemplate(key, data) {\n      var liquid = $('#' + key + '-template').html();\n      var template = Liquid.parse(liquid);\n\n      return template.render(data);\n    },\n\n    loadSchoolGroup: function loadSchoolGroup(callback) {\n      var self = app.chat;\n      $.ajax({\n        url: window.CORE_HOST + '/chat/school_group',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        callback(data);\n      });\n    },\n\n    loadGroups: function loadGroups(callback) {\n      var self = app.chat;\n      self.$loadMoreGroupsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/groups?per_page=' + self.groupsPagination.perPage + '&page=' + (self.groupsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.groupsPagination.page = self.groupsPagination.page + 1;\n        self.$loadMoreGroupsButton.removeAttr('disabled', 'disabled');\n        callback(data);\n      });\n    },\n\n    loadCollaborators: function loadCollaborators(callback) {\n      var self = app.chat;\n      self.$loadMoreCollaboratorsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/collaborators?per_page=' + self.collaboratorsPagination.perPage + '&page=' + (self.collaboratorsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.collaboratorsPagination.page = self.collaboratorsPagination.page + 1;\n        self.$loadMoreCollaboratorsButton.removeAttr('disabled', 'disabled');\n        callback(data);\n      });\n    },\n\n    loadFollows: function loadFollows(callback) {\n      var self = app.chat;\n      self.$loadMoreStudentsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/follows?per_page=' + self.followsPagination.perPage + '&page=' + (self.followsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.followsPagination.page = self.followsPagination.page + 1;\n        self.$loadMoreStudentsButton.removeAttr('disabled', 'disabled');\n        callback(data);\n      });\n    },\n\n    didLoadSchoolGroup: function didLoadSchoolGroup(group) {\n      var self = app.chat;\n\n      group.is_school = true;\n\n      var $html = $(self.renderTemplate('chat-group-list-item', group));\n      $html.on('click', app.chat.changeRoom);\n      self.$groups.prepend($html);\n    },\n\n    didLoadGroups: function didLoadGroups(data) {\n      var self = app.chat;\n\n      self.groupsPagination.totalPages = data.total_pages;\n\n      if (self.groupsPagination.page >= self.groupsPagination.totalPages) {\n        self.$loadMoreGroupsButton.attr('disabled', 'disabled');\n      }\n\n      var groups = data.groups;\n      groups = _.sortBy(groups, { is_school: false });\n      groups = _.map(groups, function (g) {\n        g.is_school = false;\n        return g;\n      });\n\n      groups.forEach(function (group) {\n        var $html = $(self.renderTemplate('chat-group-list-item', group));\n        $html.on('click', app.chat.changeRoom);\n        self.$groups.append($html);\n      });\n\n      self.selectFirstRoomAvailable();\n    },\n\n    didLoadCollaborators: function didLoadCollaborators(data) {\n      var self = app.chat;\n\n      self.collaboratorsPagination.totalPages = data.total_pages;\n\n      if (self.collaboratorsPagination.page >= self.collaboratorsPagination.totalPages) {\n        self.$loadMoreCollaboratorsButton.attr('disabled', 'disabled');\n      }\n\n      self.addProfileItems(data.collaborators, 'js-team');\n      self.selectFirstRoomAvailable();\n    },\n\n    didLoadFollows: function didLoadFollows(data) {\n      var self = app.chat;\n      self.followsPagination.totalPages = data.total_pages;\n\n      if (self.followsPagination.page >= self.followsPagination.totalPages) {\n        self.$loadMoreStudentsButton.attr('disabled', 'disabled');\n      }\n\n      self.addProfileItems(data.users, 'js-students');\n      self.selectFirstRoomAvailable();\n    },\n\n    addProfileItems: function addProfileItems(users, divClass) {\n      var self = app.chat;\n\n      users.forEach(function (user) {\n        var $html = $(self.renderTemplate('chat-profile-list-item', user));\n        $html.on('click', app.chat.changeRoom);\n        $('.' + divClass).append($html);\n      });\n    },\n\n    changeRoom: function changeRoom(event) {\n      var self = app.chat;\n      var $element = $(event.currentTarget);\n\n      $(\".chat-sidebar-list-item\").removeClass('active');\n      $element.addClass('active');\n\n      var roomName = 'messages';\n\n      if ($element.data('type') === 'products') {\n        // room name on firebase\n        roomName += '_products/' + $element.data('id');\n\n        // change room name on div\n        self.$roomTitle.html($('.js-chat-group-name', $element).html());\n        self.$roomUsersCount.html($('.js-chat-group-users-count', $element).html());\n      } else if ($element.data('type') === 'users') {\n        var ids = [self.userId, parseInt($element.data('id'))].sort();\n        roomName += '_users/' + ids[0] + '/' + ids[1];\n\n        // change room name on div\n        self.$roomTitle.html($('.info .name', $element).html());\n        self.$roomUsersCount.html($('.info .location', $element).html());\n      } else if ($element.data('type') === 'schools') {\n        // room name on firebase\n        roomName += '_schools/' + self.schoolId;\n\n        // change room name on div\n        self.$roomTitle.html($('.js-chat-group-name', $element).html());\n        self.$roomUsersCount.html($('.js-chat-group-users-count', $element).html());\n      }\n\n      self.$messagesContainer.html('');\n\n      if (self.messages) {\n        self.messages.off();\n      }\n\n      self.messages = self.database.ref(roomName);\n      self.loadMessages();\n    },\n\n    selectFirstRoomAvailable: function selectFirstRoomAvailable() {\n      if (!self.$selectedRoom) {\n        // Select first room\n        self.$selectedRoom = $(\".chat-sidebar-list-item\").first();\n        self.$selectedRoom.click();\n      }\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindCheckout = function () {\n    $('#js-terms-of-use-check').change(function () {\n      if ($(this).is(\":checked\") === true) {\n        $('.cta-checkout-cart').removeClass('disabled');\n      } else {\n        $('.cta-checkout-cart').addClass('disabled');\n      }\n    });\n\n    $(document).trigger('app:bind:checkout');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.ckeditor = {\n    bindCkeditor: function bindCkeditor() {\n      var src = '//cdn.edools.com/libs/ckeditor/4.5.10/ckeditor.js';\n\n      if ($('.js-ckeditor').length) {\n        loadAsset('window.CKEDITOR', src, function () {\n          var config = {\n            language: 'pt-br',\n            skin: 'bootstrapck'\n          };\n\n          $('.js-ckeditor').each(function (index, ckeditorObj) {\n            if (!$('#cke_' + ckeditorObj.id).length) {\n              config.placeholder = ckeditorObj.placeholder; // TODO: fix it\n\n              CKEDITOR.replace(ckeditorObj.id, config);\n            }\n          });\n\n          app.ckeditor.bindCkeditorSubmit();\n          $(document).trigger('app:bind:ckeditor');\n        });\n      }\n    },\n\n    bindCkeditorSubmit: function bindCkeditorSubmit() {\n      $.each($('.js-ckeditor'), function (index, editor) {\n        var $editor = $(editor);\n        var $form = $editor.parents('form');\n        var editorId = $editor.attr('id');\n\n        if ($form) {\n          var $submitButton = $form.find('button[type=\"submit\"]');\n\n          CKEDITOR.instances[editorId].on('change', function () {\n            if (this.getData().length) {\n              $submitButton.attr('disabled', false);\n            } else {\n              $submitButton.attr('disabled', true);\n            }\n          });\n        }\n      });\n\n      $(document).trigger('app:bind:ckeditor_submit');\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindCollaborativeDiscussion = function () {\n    $(document).on('click', '#collaborative-discussion .js-edit-button', function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').addClass('hide');\n      $comment.find('.js-edit-container').removeClass('hide');\n    });\n\n    $(document).on('click', '#collaborative-discussion .js-cancel-button', function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').removeClass('hide');\n      $comment.find('.js-edit-container').addClass('hide');\n    });\n\n    $(document).trigger('app:bind:collaborative_discussion');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindDatepicker = function () {\n    // TODO: Handle i18n\n    $.fn.datepicker.defaults.language = 'pt-BR';\n\n    $('.datepicker').each(function (i, el) {\n      var $el = $(el);\n      var $hidden = $('<input type=\"hidden\" />').insertBefore($el.parent());\n      var frontDate = moment($el.val()).utc().format('DD/MM/YYYY');\n      var serverDate = moment($el.val()).utc().format('YYYY-MM-DD');\n      serverDate = serverDate === 'Invalid date' ? null : serverDate;\n\n      $hidden.attr('id', $el.attr('id'));\n      $hidden.attr('name', $el.attr('name'));\n      $hidden.attr('value', serverDate);\n\n      $el.removeAttr('id');\n      $el.removeAttr('name');\n\n      if ($el.val() !== \"\") {\n        $el.val(frontDate);\n      }\n\n      $(el).datepicker().on('change', function () {\n        var date = moment($el.val(), 'DD/MM/YYYY').utc().format('YYYY-MM-DD');\n        date = date === 'Invalid date' ? null : date;\n        $hidden.val(date);\n      });\n    });\n\n    $(document).trigger('app:bind:datepicker');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindExamQuestionForm = function () {\n    $(document).on('click', '#js-remake-exam', function () {\n      $('#answers-container').addClass('hide');\n      $('#form-container').removeClass('hide');\n    });\n\n    $(document).on('click', '.js-clean-associative-options', function () {\n      $(this).parents('.associative-question').find('.js-associative-select option:selected').removeAttr('selected');\n    });\n\n    $(document).on('change', '.js-associative-select', function () {\n      var $question = $(this).parents('.associative-question');\n      var optionIndex = $(this).data('option-index');\n      var assertionId = $(this).find('option:selected').data('first-assertion-id');\n\n      $question.find('.js-associate-assertion[data-option-index=\"' + optionIndex + '\"]').val(assertionId);\n    });\n\n    // bind all form's inputs\n    $(document).on('change', '#exam_answer_form', app.checkFormValidity);\n    // bind all form's textareas for all types of typing\n    $(document).on('input propertychange', '#exam_answer_form', app.checkFormValidity);\n\n    $(document).trigger('app:bind:bind_exam_question_form');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindFixOnScroll = function () {\n    $('.js-fix-on-scroll').each(function (i, el) {\n      if (!$(el).hasClass('js-fix-on-scroll-mobile') && window.innerWidth < 992) {\n        return;\n      }\n\n      var $el = $(el);\n      $el.wrap('<div class=\"js-fix-scroll-wrapper\"/>');\n      var $wrapper = $el.parent('.js-fix-scroll-wrapper');\n\n      var offset = $el.offset();\n      var size = {\n        width: $el.outerWidth(),\n        height: $el.outerHeight()\n      };\n\n      $wrapper.width(size.width);\n      $wrapper.height(size.height);\n\n      $(document).on('scroll', function (e) {\n        var scrollTop = $(document).scrollTop();\n\n        if (scrollTop >= offset.top) {\n          if ($el.css('position') === 'fixed') return;\n\n          $el.parent().addClass('scroll');\n          $el.addClass('scroll');\n          $el.css({\n            position: 'fixed',\n            left: offset.left,\n            top: 0,\n            width: size.width,\n            height: size.height,\n            'z-index': '10000'\n          });\n        } else {\n          if ($el.css('position') === 'static') return;\n\n          $el.removeClass('scroll');\n          $el.parent().removeClass('scroll');\n          $el.css({\n            position: 'static',\n            left: 'auto',\n            top: 'auto',\n            width: 'auto',\n            height: 'auto'\n          });\n        }\n      });\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.followBind = function () {\n    $(document).on({\n      mouseenter: function mouseenter() {\n        $(this).addClass('hidden');\n        $('#js-unfollow').removeClass('hidden');\n      }\n    }, '#js-following');\n\n    $(document).on({\n      mouseleave: function mouseleave() {\n        $('#js-following').removeClass('hidden');\n        $(this).addClass('hidden');\n      }\n    }, '#js-unfollow');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindHome = function () {\n    $('.js-hero-slider').owlCarousel({\n      items: 1,\n      loop: true,\n      autoplay: true,\n      autoplayTimeout: 7000,\n      dots: false,\n      nav: false\n    });\n\n    $('.js-hero-videos-slider').owlCarousel({\n      items: 3,\n      loop: true,\n      dots: true,\n      nav: false,\n      margin: 5\n    });\n\n    $('.js-hero-videos .js-videos-nav a').on('click', function (e) {\n      e.preventDefault();\n\n      var $el = $(this);\n      var $html = $($el.data('html'));\n\n      $('.js-hero-videos .js-video-container').html($html);\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.lessonList = {\n    init: function init() {\n      var self = this;\n\n      self.courseTreeExists = self.courseTree().length;\n      self.isActive = self.courseTree().data('is-active');\n      self.course = self.courseTree().data('course');\n      self.enrollment = self.courseTree().data('enrollment');\n      self.courseContent = self.courseTree().data('course-content');\n      self.userType = self.courseTree().data('user-type');\n      self.lessonActions = self.courseTree().data('lesson-actions');\n      self.downloadAction = self.courseTree().data('download-action');\n      self.currentLessonId = parseInt(self.courseTree().data('current-lesson-id'));\n      self.apiKey = self.courseTree().data('api-key');\n\n      self.translations = {};\n      self.translations['lesson.release_at'] = self.courseTree().data('translation-release-at');\n      self.translations['lesson.release_after'] = self.courseTree().data('translation-release-after');\n      self.translations['product.course_content.views'] = self.courseTree().data('translation-course_content-views');\n\n      if (self.lessonProgress() && self.lessonProgress().completed) {\n        $('.btn-next-lesson').removeClass('disabled');\n      }\n\n      if (self.courseTreeExists && !self.isActive) {\n        self.bindClicks();\n        self.handleLessons();\n        self.loadTopModules();\n        self.bindChangeLesson();\n\n        $(document).trigger('app:bind:lesson_sidebar');\n\n        $(document).on('lesson-completed', function (event, lessonProgress) {\n          var $mediaControls = $('.btn-next-lesson');\n          var enrollmentId = lessonProgress.data.enrollment_id;\n\n          if (self.progressIcon('completed').hasClass('hide')) {\n            self.progressIcon('completed').removeClass('hide');\n          }\n\n          if (!self.progressIcon('progress').hasClass('hide')) {\n            self.progressIcon('progress').addClass('hide');\n          }\n\n          if ($mediaControls.size() > 0) {\n            $mediaControls.removeClass('disabled');\n          }\n\n          app.lessonList.requirementsExists(lessonProgress.data, function ($item, content_id) {\n            if ($item && content_id) {\n              app.lessonList.checkLessonCompleted(enrollmentId, content_id, function (completed) {\n                if (completed) {\n                  $item.removeClass('blocked');\n                  $item.find('.right > .icon-lock').remove();\n                }\n              });\n            }\n          });\n        });\n      }\n    },\n\n    // Props\n\n    courseTree: function courseTree() {\n      return $('.course-content #js-course-tree-ajax');\n    },\n\n    lazyLoadButtons: function lazyLoadButtons() {\n      return $('.course-content #js-course-content-more-link, .course-content #js-course-content-prev-link');\n    },\n\n    lessons: function lessons() {\n      return this.courseTree().find('.js-content');\n    },\n\n    currentLesson: function currentLesson() {\n      return $(this.courseTree().find('.js-content.active')[0]);\n    },\n\n    toggleButton: function toggleButton() {\n      return $('.lesson-list-toggle .btn');\n    },\n\n    lessonListPanel: function lessonListPanel() {\n      return $('.lesson-list-panel');\n    },\n\n    lessonProgress: function lessonProgress() {\n      return $('#js-media-player').data('lesson-progress');\n    },\n\n    progressIcon: function progressIcon(type) {\n      var iconType = {\n        completed: '.js-completed-icon',\n        progress: '.js-in-progress-icon'\n      };\n\n      return this.currentLesson().find(iconType[type]);\n    },\n\n    requirementsExists: function requirementsExists(lessonProgress, cb) {\n      if (!lessonProgress) {\n        return false;\n      }\n\n      var requirementsElements = $('.lesson-list-panel [data-requirements]').filter(function (index, item) {\n        return $(item).data('requirements').length > 0;\n      });\n\n      var requirementsUnified = requirementsElements.map(function (idx, item) {\n        return {\n          item: $(item),\n          requirements: $(item).data('requirements')\n        };\n      }).toArray();\n\n      var exists = _.find(requirementsUnified, { requirements: [{ content_id: lessonProgress.lesson_id }] });\n\n      if (exists) {\n        var $item = exists.item;\n        if (cb) {\n          return cb($item, lessonProgress.lesson_id);\n        }\n      } else {\n        if (cb) {\n          return cb(null);\n        }\n      }\n    },\n\n    checkLessonCompleted: function checkLessonCompleted(enrollmentId, id, cb) {\n      var self = this;\n      var completed = false;\n      var apiKey = $('.course-content #js-course-tree-ajax').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/enrollments/' + enrollmentId + '/lessons_progresses?lesson_id=' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        }\n      }).success(function (data) {\n        completed = data.lessons_progresses[0].completed;\n\n        cb(completed);\n      });\n    },\n\n    // Actions\n    bindChangeLesson: function bindChangeLesson() {\n      var self = this;\n\n      if (!self.bindChangeLessonActive) {\n        self.bindChangeLessonActive = true;\n        var course_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+$/;\n        var lesson_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+\\/course_contents\\/\\d+$/;\n\n        $(document).on(\"ready page:load\", function (e) {\n          var path = window.location.pathname;\n          var lesson_path = lesson_path_regex.test(path);\n\n          if (course_path_regex.test(path) || lesson_path) {\n            self.lessons().removeClass('active');\n\n            if (lesson_path) {\n              var path_array = path.split('/');\n              var content_id = path_array[path_array.length - 1];\n\n              $(\"#content-\" + content_id + \".js-content\").addClass('active');\n            }\n          }\n        });\n      }\n    },\n\n    bindClicks: function bindClicks() {\n      var self = this;\n\n      self.lessons().find('a').on('click', function (e) {\n        e.preventDefault();\n        app.lessonList.changeLesson(null, $(this).parents('.js-content'));\n      });\n\n      self.courseTree().on('click', '.module', function (e) {\n        if (!$(e.target).hasClass('module') && !$(e.target).parent().hasClass('module')) {\n          return;\n        }\n\n        e.stopPropagation();\n\n        self.loadChildren($(this));\n      });\n\n      self.courseTree().data('is-active', true);\n\n      self.toggleButton().on('click', this.toggleSidebar);\n    },\n\n    getLessonIcon: function getLessonIcon(lesson) {\n      var lessonIcon = '';\n\n      if (lesson.type === 'ExamLesson' && lesson.activity) {\n        switch (lesson.activity.type) {\n          case 'Quiz':\n            {\n              lessonIcon = '-puzzle';\n              break;\n            }\n          case 'FileUpload':\n            {\n              lessonIcon = 'icon-arrow-up-circle';\n              break;\n            }\n          case 'CollaborativeDiscussion':\n            {\n              lessonIcon = 'icon-people';\n              break;\n            }\n          default:\n            {\n              lessonIcon = 'icon-puzzle';\n            }\n        }\n      } else if (lesson.media) {\n        switch (lesson.media.type) {\n          case 'Video':\n            {\n              lessonIcon = 'icon-camrecorder';\n              break;\n            }\n          case 'Audio':\n            {\n              lessonIcon = 'icon-microphone';\n              break;\n            }\n          case 'Slide':\n            {\n              lessonIcon = 'icon-chart';\n              break;\n            }\n          case 'Document':\n            {\n              lessonIcon = 'icon-doc';\n              break;\n            }\n          case 'Image':\n            {\n              lessonIcon = 'icon-picture';\n              break;\n            }\n          case 'Text':\n            {\n              lessonIcon = 'icon-doc';\n              break;\n            }\n          case 'LiveStream':\n            {\n              lessonIcon = 'icon-control-play';\n              break;\n            }\n          case 'VideoSlide':\n            {\n              lessonIcon = 'icon-film';\n              break;\n            }\n          case 'ScormPackage':\n            {\n              lessonIcon = 'icon-layers';\n              break;\n            }\n          case 'Html':\n            {\n              lessonIcon = 'icon-doc';\n              break;\n            }\n          case 'Html5':\n            {\n              lessonIcon = 'icon-docs';\n              break;\n            }\n          default:\n            {\n              lessonIcon = 'icon-camrecorder';\n            }\n\n        }\n      }\n\n      return lessonIcon;\n    },\n\n    getContentPath: function getContentPath(content) {\n      var self = this;\n\n      var enrollmentId = self.enrollment.id;\n      var courseId = self.course.id;\n\n      var path = enrollmentId ? '/enrollments/' + enrollmentId : '/admin_view';\n      path = path + '/courses/' + courseId + '/course_contents/' + content.id;\n\n      return path;\n    },\n\n    getContentDownloadPath: function getContentDownloadPath(content) {\n      var self = this;\n      return self.getContentPath(content) + '/download';\n    },\n\n    checkLessonAvailability: function checkLessonAvailability(lesson) {\n      var releaseAt = lesson.release_at;\n      var releaseAfter = lesson.release_after;\n\n      if (!releaseAt && !releaseAfter) {\n        return true;\n      }\n\n      var enrollmentActivatedAt = moment(this.enrollment.activated_at);\n\n      var releaseTime = releaseAt ? moment(releaseAt) : enrollmentActivatedAt.add(releaseAfter, 'days');\n\n      return moment() > releaseTime;\n    },\n\n    checkTrialByType: function checkTrialByType(type, id) {\n      var $tree = $('#js-course-tree-ajax');\n      var enrollment = $tree.data('enrollment');\n      var constrains_name = 'trial_' + type + '_ids';\n\n      var payment_method = enrollment && enrollment.payment_method;\n      var constrains_tree = $tree.data('school-product') && $tree.data('school-product').trial_constrains;\n      var constrains = constrains_tree && payment_method && constrains_tree[payment_method];\n\n      if (constrains && !constrains.hasOwnProperty(constrains_name)) {\n        return false;\n      }\n\n      if (enrollment && !enrollment['on_trial?']) {\n        return false;\n      }\n\n      if (constrains_tree && constrains[constrains_name]) {\n        return constrains[constrains_name].indexOf(id) > -1;\n      }\n\n      return false;\n    },\n\n    fetchModules: function fetchModules($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function success(res) {\n          var modules = _.sortBy(res.course_modules, 'order');\n\n          modules = _.filter(modules, function (m) {\n            var module = _.find(self.allModules, { id: m.id });\n            return module.available !== false && (module.course_content_ids.length > 0 || module.course_modules.length > 0);\n          });\n\n          var $modules = _.map(modules, function (module) {\n            return $('<li class=\"list-group-item module\" ' + 'data-id=\"' + module.id + '\"' + 'data-level=\"' + (level + 1) + '\">' + '<i class=\"icon icon-arrow-right\"></i>' + '<span>' + module.name + '</span>' + '<i class=\"busy busy-xs\"></i>' + '</li>');\n          });\n\n          $list.append($modules);\n        }\n      });\n    },\n\n    fetchChildren: function fetchChildren($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id + '/course_contents',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function success(res) {\n          var courseContents = _.filter(res.course_contents, function (lesson) {\n            return lesson.available !== false;\n          });\n\n          courseContents = _.sortBy(courseContents, 'order');\n\n          if (self.enrollment) {\n            courseContents = _.map(courseContents, function (content) {\n              content.completed = self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(content.lesson.id) > -1;\n              return content;\n            });\n          }\n\n          var $courseContents = _.map(courseContents, function (content) {\n            var active = self.currentLessonId === content.lesson.id ? 'active js' : '';\n            var lesson = content.lesson;\n            var lessonIcon = self.getLessonIcon(lesson);\n            var hideInProgressIcon = 'hide';\n            var hideCompletedIcon = 'hide';\n            var lessonReleased = null;\n            var releaseType = null;\n            var releaseDate = null;\n            var progress = null;\n            var requirements = content.requirements;\n            var available = true;\n            var requirements_ids = requirements.map(function (item) {\n              return item.content_id;\n            });\n\n            if (self.enrollment) {\n              lessonReleased = self.checkLessonAvailability(lesson);\n\n              if (self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(lesson.id) > -1) {\n                hideInProgressIcon = 'hide';\n                hideCompletedIcon = null;\n              } else {\n                if (self.enrollment.lessons_info && self.enrollment.lessons_info.in_progress.indexOf(lesson.id) > -1) {\n                  hideInProgressIcon = null;\n                  hideCompletedIcon = 'hide';\n                } else {\n                  hideInProgressIcon = 'hide';\n                  hideCompletedIcon = 'hide';\n                }\n              }\n\n              if (lesson.release_at) {\n                releaseType = 'release_at';\n                releaseDate = lesson.release_at;\n              } else if (lesson.release_after) {\n                releaseType = 'release_after';\n                releaseDate = moment(self.enrollment.activated_at).add(lesson.release_after, 'days');\n              }\n\n              if (self.lessonActions) {\n                progress = _.find(self.enrollment.lessons_progresses, { lesson_id: lesson.id });\n              }\n            }\n\n            if (self.enrollment) {\n              _.each(requirements_ids, function (id) {\n                var exists = _.find(courseContents, { content_id: id, completed: true });\n\n                if (!exists) {\n                  available = false;\n                }\n              });\n            }\n\n            if (content.completed) {\n              $('.btn-next-lesson').removeClass('disabled');\n            }\n\n            var html = '<li class=\"list-group-item content-lesson js-content list-group-item lesson module-item ' + active + (!available || self.enrollment && self.checkTrialByType('content', content.id) ? ' blocked' : '') + '\" ' + 'id=\"content-' + content.id + '\" ' + 'data-requirements=\\'' + JSON.stringify(requirements) + '\\'' + 'data-id=\"' + content.lesson.id + '\"' + 'data-level=\"1\">' + '<div id=\"lesson-' + lesson.id + '\" class=\"js-lesson content-lesson ' + active + (!lessonReleased ? ' not-released' : '') + '\" data-lesson-id=\"' + lesson.id + '\">' + '<div class=\"class-info\">' + '<div class=\"left\"><i class=\"' + lessonIcon + '\"></i></div>' + '<div class=\"center\">' + (self.lessonActions && lessonReleased ? '<a class=\"lesson-title\" href=\"' + self.getContentPath(content) + '\"><span>' + lesson.title + '</span></a>' : '<span class=\"lesson-title\"><span class=\"disabled\">' + lesson.title + '</span></span>') + '</div>' + '<div class=\"right\">' + (!available || self.enrollment && self.checkTrialByType('content', content.id) ? '<i class=\"icon-lock\"></i>' : '') + '<span class=\"progress-icon js-progress-icons\">' + '<i class=\"icon-check js-completed-icon ' + hideCompletedIcon + '\"></i>' + '<i class=\"icon-clock js-in-progress-icon ' + hideInProgressIcon + '\"></i>' + '</span>';\n\n            if (self.lessonActions) {\n              if (progress && progress.views <= self.enrollment.max_attendance_length && self.enrollment.max_attendance_type == 'attempts') {\n                var translation = self.translations['product.course_content.views'];\n\n                translation = translation.replace('{{ progress.views }}', progress.views);\n                translation = translation.replace('{{ enrollment.max_attendance_length }}', self.enrollment.max_attendance_length);\n\n                html += '<span class=\"lesson-views attempt js-attendance badge\" title=\"' + translation + '\" data-tooltip-placement=\"left\" data-toggle=\"tooltip\">' + '<span>' + progress.views + '/' + self.enrollment.max_attendance_length + '</span>' + '</span>';\n              }\n\n              if (!lessonReleased) {\n                var zone = moment.tz.guess();\n                html += '<span class=\"release-date badge\">' + self.translations['lesson.' + releaseType] + '<span> ' + moment.tz(releaseDate, zone).format('DD/MM/YYYY') + '</span>' + '</span>';\n              }\n\n              if (self.downloadAction && content.downloadable) {\n                html += '<a class=\"download-link\" href=\"' + self.getContentDownloadPath(content) + '\" data-no-turbolink>' + '<i class=\"icon-cloud-download\"></i>' + '</a>';\n              }\n            }\n\n            html += '</div>' + '</div>' + '</li>';\n\n            return $(html);\n          });\n\n          $list.append($courseContents);\n          self.checkNextButtonUnlocked();\n        }\n      });\n    },\n\n    checkNextButtonUnlocked: function checkNextButtonUnlocked() {\n      var lessonProgress = this.lessonProgress();\n\n      app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n        if ($item && content_id) {\n          if (!content_id || !lessonProgress.hasOwnProperty('enrollment_id')) {\n            return;\n          }\n\n          app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n            if (completed) {\n              $('.btn-next-lesson').removeClass('disabled');\n              $item.removeClass('blocked');\n              $item.find('.right > .icon-lock').remove();\n            }\n          });\n        } else {\n          $('.btn-next-lesson').removeClass('disabled');\n        }\n      });\n    },\n\n    loadTopModules: function loadTopModules() {\n      var self = this;\n\n      if (!self.course) return;\n\n      $.ajax({\n        url: window.CORE_HOST + '/courses/' + self.course.id + '/course_modules',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function success(res) {\n          if (!res.course_modules || res.course_modules.length <= 0) return;\n\n          self.allModules = res.course_modules;\n\n          self.topModules = _.filter(res.course_modules, function (x) {\n            return !x.parent_course_module && x.available !== false && (x.course_content_ids.length > 0 || x.course_modules.length > 0);\n          });\n\n          self.topModules = _.sortBy(self.topModules, 'order');\n\n          var $modules = _.map(self.topModules, function (module) {\n            var disabled = self.enrollment && self.checkTrialByType('module', module.id);\n\n            return $('<li class=\"list-group-item module ' + (disabled ? 'disabled' : '') + '\" ' + 'data-id=\"' + module.id + '\"' + 'data-level=\"1\">' + '<i class=\"icon icon-arrow-right\"></i>' + '<span>' + module.name + '</span>' + '<i class=\"busy busy-xs\"></i>' + '</li>');\n          });\n\n          self.courseTree().prev('.course-content-busy').fadeOut('fast', function () {\n            self.courseTree().css('display', 'none');\n            self.courseTree().html($modules);\n            self.courseTree().fadeIn('fast');\n\n            if (self.courseContent) {\n              self.expandParentModules(self.courseContent.parent_modules_hash);\n            }\n          });\n        }\n      });\n    },\n\n    loadChildren: function loadChildren(parent, cb) {\n      var self = this;\n      var $parent = $(parent);\n\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      if ($list.length <= 0) {\n        $parent.find('.busy').css({ opacity: 1 });\n        $list = $('<ul class=\"list-group\" style=\"display: none;\"></ul>');\n        $list.appendTo($parent);\n\n        $.when(self.fetchModules($parent), self.fetchChildren($parent)).then(function () {\n          $parent.addClass('expanded');\n          $parent.find('.busy').css({ opacity: 0 });\n\n          $list.slideDown('fast');\n\n          if (typeof cb === 'function') {\n            cb();\n          }\n        });\n      } else {\n        if ($parent.hasClass('expanded')) {\n          $parent.removeClass('expanded');\n          $list.slideUp('fast');\n        } else {\n          $parent.addClass('expanded');\n          $list.slideDown('fast');\n        }\n\n        if (typeof cb === 'function') {\n          cb();\n        }\n      }\n    },\n\n    handleLessons: function handleLessons() {\n      $(document).on('page:load page:restore', function (e) {\n\n        if (!e.originalEvent || !e.originalEvent.data || e.originalEvent.data.length == 0) return;\n\n        var $html = $(e.originalEvent.data[0]);\n        app.lessonList.lessons().each(function (i, el) {\n          var $el = $(el);\n          var $new = $html.find('#' + $el.attr('id'));\n          $el.html($new.html());\n        });\n      });\n    },\n\n    changeLesson: function changeLesson(direction, lesson) {\n      var $targetLesson = $(lesson);\n\n      if (direction === 'prev') {\n        var $prev = app.lessonList.currentLesson().prevAll('.js-content');\n\n        if ($prev.length > 0 && $prev.find('a').length > 0) $targetLesson = $($prev[0]);\n      } else if (direction === 'next') {\n        var $next = app.lessonList.currentLesson().nextAll('.js-content');\n\n        if ($next.length > 0 && $next.find('a').length > 0) $targetLesson = $($next[0]);\n      }\n\n      $targetLesson.find('a')[0].click();\n    },\n\n    expandParentModules: function expandParentModules(parentModules) {\n      var self = this;\n\n      var modules = [];\n      var loopModule = parentModules.course_module;\n      modules.push(loopModule.id);\n\n      while (loopModule.parent_module) {\n        loopModule = loopModule.parent_module;\n        modules.push(loopModule.id);\n      }\n\n      modules = modules.reverse();\n\n      async.eachSeries(modules, function (moduleId, cb) {\n        var $module = $('.module[data-id=\"' + moduleId + '\"]');\n        self.loadChildren($module, cb);\n      });\n    },\n\n    toggleSidebar: function toggleSidebar() {\n      app.lessonList.toggleButton().toggleClass('active');\n      app.lessonList.lessonListPanel().toggleClass('active');\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.lessonPage = function () {\n    var REGEX_COLLABORATIVE_DISCUSSIONS = /\\/collaborative_discussions\\/([0-9]+)\\/collaborative_comments/;\n    var REGEX_EXAM_ANSWERS = /\\/exam_answers/;\n\n    var isCollaborativeDiscuttion = function isCollaborativeDiscuttion(value) {\n      return REGEX_COLLABORATIVE_DISCUSSIONS.test(value);\n    };\n\n    var isExamAnswer = function isExamAnswer(value) {\n      return REGEX_EXAM_ANSWERS.test(value);\n    };\n\n    $(document).ajaxSuccess(function (event, xhr, settings) {\n      if (isCollaborativeDiscuttion(settings.url) || isExamAnswer(settings.url)) {\n        var lessonProgress = app.lessonList.lessonProgress();\n\n        app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n          if (content_id && lessonProgress.enrollment_id) {\n            app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n              if (completed) {\n                var $currentItemIcon = app.lessonList.currentLesson().find('.js-in-progress-icon');\n                $currentItemIcon.removeClass('icon-clock');\n                $currentItemIcon.removeClass('js-in-progress-icon');\n                $currentItemIcon.addClass('js-in-completed-icon');\n                $currentItemIcon.addClass('icon-check');\n\n                $('.btn-next-lesson').removeClass('disabled');\n                $item.removeClass('disabled');\n                $item.removeClass('blocked');\n                $item.find('.right > .icon-lock').remove();\n              }\n            });\n          }\n        }, function () {\n          $('.btn-next-lesson').removeClass('disabled');\n        });\n      }\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindMasks = function () {\n    var phoneMaskBehavior = function phoneMaskBehavior(val) {\n      return val.replace(/\\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';\n    };\n\n    var phoneMaskOptions = {\n      onKeyPress: function onKeyPress(val, e, field, options) {\n        field.mask(phoneMaskBehavior.apply({}, arguments), options);\n      }\n    };\n\n    $('#user-phone').mask(phoneMaskBehavior, phoneMaskOptions);\n    $('#user-cpf').mask('999.999.999-99');\n    $('#user-cep').mask('99.999-999');\n\n    $(document).trigger('app:bind:masks');\n  };\n})();\n\napp.notepad = {\n  page: 1,\n\n  noteContainer: function noteContainer() {\n    return $('#notepad-container');\n  },\n\n  form: function form() {\n    return $('#js-notepad-form');\n  },\n\n  loadNote: function loadNote(lesson_id, cb) {\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'GET',\n      success: function success() {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  saveNote: function saveNote(cb) {\n    var note = $(\"#js-note\").html();\n    var note_id = $(\"#js_note_id\").val();\n\n    var $button = $(\"#save_notepad_button\");\n    var buttonLabel = $button.html();\n    $button.html($button.data(\"sending\"));\n    $button.prop('disabled', true);\n\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'POST',\n      data: {\n        _id: note_id,\n        note: note\n      },\n      success: function success() {\n        $button.html(buttonLabel);\n        $button.prop('disabled', false);\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  init: function init() {\n    var self = this;\n    if (this.noteContainer().length <= 0) return;\n    this.loadNote($(\"#lesson_id\").val());\n\n    $(\"#notepad_form\").on('submit', function (event) {\n      event.preventDefault();\n      self.saveNote();\n    });\n  }\n};\n\n(function () {\n  'use strict';\n\n  app.pagarme = {\n    buildCreditCard: function buildCreditCard() {\n      var creditCard = new PagarMe.creditCard();\n      var expiration = $(\"#card-form #card-expiration\").val().split('/');\n\n      creditCard.cardExpirationMonth = parseInt(expiration[0]);\n      creditCard.cardExpirationYear = parseInt(expiration[1]);\n      creditCard.cardHolderName = $(\"#card-form #card-holder-name\").val();\n      creditCard.cardNumber = $(\"#card-form #card-number\").val();\n      creditCard.cardCVV = $(\"#card-form #card-cvc\").val();\n\n      return creditCard;\n    },\n\n    submitFormCreditCardHash: function submitFormCreditCardHash(paymentForm) {\n      var creditCard = app.pagarme.buildCreditCard();\n      var fieldErrors = creditCard.fieldErrors();\n      var hasErrors = false;\n      for (var field in fieldErrors) {\n        hasErrors = true;break;\n      }\n\n      console.log(1);\n      window.creditCardTest = creditCard;\n\n      if (hasErrors) {\n        window.fieldErrors = fieldErrors;\n\n        console.log(window.fieldErrors);\n      } else {\n        creditCard.generateHash(function (cardHash) {\n          $('#card_hash').val(cardHash);\n\n          paymentForm.get(0).submit();\n        });\n      }\n    },\n\n    init: function init() {\n      var src = 'https://assets.pagar.me/js/pagarme.min.js',\n          paymentForm = $('#card-form'),\n          pagarmeKey = $(\"#pagarme\").val();\n\n      if (paymentForm.length && pagarmeKey) {\n        loadAsset('PagarMe', src, function () {\n          PagarMe.encryption_key = pagarmeKey;\n\n          paymentForm.submit(function (event) {\n            event.preventDefault();\n\n            app.pagarme.submitFormCreditCardHash(paymentForm);\n          });\n\n          $(document).trigger('app:bind:pagarme');\n        });\n      }\n    }\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindPostsForm = function () {\n    $(document).on('click', '.js-post-edit', function () {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').addClass('hidden');\n      post.find('.js-post-form').removeClass('hidden');\n    });\n\n    $(document).on('click', '.js-post-cancel', function (e) {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').removeClass('hidden');\n      post.find('.js-post-form').addClass('hidden');\n    });\n\n    $(document).trigger('app:bind:bind_posts_form');\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindProduct = function () {\n\n    $('.js-product-nav a').on('click', function (e) {\n      e.preventDefault();\n\n      var $el = $(this);\n      var target = $el.attr('href').replace('#', '');\n      var $content = $('.product-content[data-target=\"' + target + '\"]');\n\n      $('.js-product-nav a').removeClass('active');\n      $('.js-product-content').removeClass('active');\n\n      $el.addClass('active');\n      $content.addClass('active');\n    });\n\n    $('.js-product-nav a:first').click();\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.bindReadMore = function () {\n    $('[role=\"readmore\"]').each(function (i, el) {\n      var speed = $(el).data('speed') || 100;\n      var collapsedHeight = $(el).data('collapsed-height') || 200;\n      var moreText = $(el).data('more-text') || 'Leia Mais';\n      var lessText = $(el).data('less-text') || 'Fechar';\n\n      var currHeight = $(el).innerHeight();\n      var showLink = currHeight <= collapsedHeight;\n\n      $(el).readmore({\n        speed: speed,\n        collapsedHeight: collapsedHeight,\n        moreLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + moreText + '</a>',\n        lessLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + lessText + '</a>'\n      });\n    });\n  };\n})();\n\n(function () {\n  'use strict';\n\n  app.simpleEditor = {\n\n    createShortcut: function createShortcut(bindKey, callback) {\n      var isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n      var bindFunction = function bindFunction(e) {\n        var character = String.fromCharCode(e.keyCode);\n        var ctrl = e.ctrlKey;\n        var meta = !!e.metaKey;\n        var score = 0;\n\n        if (isMac && meta) {\n          score++;\n        } else if (ctrl) {\n          score++;\n        }\n\n        if (character == bindKey) {\n          score++;\n        }\n\n        if (score == 2) {\n          e.stopPropagation();\n          e.preventDefault();\n          return callback();\n        }\n      };\n\n      $('body').bind('keydown', bindFunction);\n    },\n\n    handleDrag: function handleDrag(e) {\n      e.stopPropagation();\n      e.preventDefault();\n    },\n\n    handleDrop: function handleDrop(e) {\n      e.stopPropagation();\n      e.preventDefault();\n      var x = e.clientX;\n      var y = e.clientY;\n      var file = e.dataTransfer.files[0];\n\n      var URLObj = window.URL || window.webkitURL;\n      var source = URLObj.createObjectURL(file);\n\n      if (file.type.match('image.*')) {\n\n        var img = document.createElement(\"img\");\n\n        img.src = source;\n\n        var range = null;\n\n        if (document.caretPositionFromPoint) {\n          var pos = document.caretPositionFromPoint(x, y);\n          range = document.createRange();\n          range.setStart(pos.offsetNode, pos.offset);\n          range.collapse();\n          range.insertNode(img);\n        } else if (document.caretRangeFromPoint) {\n          range = document.caretRangeFromPoint(x, y);\n          range.insertNode(img);\n        }\n      }\n    },\n\n    updateButtons: function updateButtons() {\n      var bold = document.queryCommandState(\"Bold\");\n      var italic = document.queryCommandState(\"Italic\");\n      var underline = document.queryCommandState(\"Underline\");\n\n      if (bold === true) {\n        $('[data-action=bold]').addClass('active');\n      } else {\n        $('[data-action=bold]').removeClass('active');\n      }\n\n      if (italic === true) {\n        $('[data-action=italic]').addClass('active');\n      } else {\n        $('[data-action=italic]').removeClass('active');\n      }\n\n      if (underline === true) {\n        $('[data-action=underline]').addClass('active');\n      } else {\n        $('[data-action=underline]').removeClass('active');\n      }\n    },\n\n    init: function init(container) {\n      this.$container = $(container);\n\n      this.$input = this.$container.find('.js-input');\n      this.$btnAction = this.$container.find('.js-btn-action');\n\n      this.registerTriggers();\n      this.registerDropZone();\n      this.registerShortcuts();\n    },\n\n    registerTriggers: function registerTriggers() {\n      var self = this;\n\n      self.$btnAction.on('click', function () {\n        var action = $(this).attr('data-action');\n        document.execCommand(action);\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('click', function () {\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('focusin', function () {\n        self.$container.addClass('focused');\n      });\n\n      self.$input.on('focusout', function () {\n        self.$container.removeClass('focused');\n      });\n    },\n\n    registerDropZone: function registerDropZone() {\n      var dropZone = $(this.container).find('.js-input');\n      dropZone.on('dragover', app.simpleEditor.handleDrag, false);\n      dropZone.on('drop', app.simpleEditor.handleDrop, false);\n    },\n\n    registerShortcuts: function registerShortcuts() {\n\n      app.simpleEditor.createShortcut('U', function () {\n        document.execCommand('underline');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('B', function () {\n        document.execCommand('bold');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('I', function () {\n        document.execCommand('italic');\n        app.simpleEditor.updateButtons();\n      });\n    }\n  };\n})();\n\napp.studentDoubts = {\n  page: 1,\n\n  doubtsContainer: function doubtsContainer() {\n    return $('#js-doubts-container');\n  },\n\n  form: function form() {\n    return $('#js-student-doubts-form');\n  },\n\n  expandButton: function expandButton() {\n    return $('#js-expand-student-doubts-form');\n  },\n\n  hideButton: function hideButton() {\n    return $('#js-hide-student-doubts-form');\n  },\n\n  loadMoreButton: function loadMoreButton() {\n    return $('#js-load-more-doubts');\n  },\n\n  loadDoubts: function loadDoubts(cb) {\n    var self = this;\n\n    $.ajax({\n      url: window.location.pathname + '/student_doubts/page/' + self.page,\n      method: 'GET',\n      data: {\n        per_page: 3\n      },\n      complete: function complete() {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  init: function init() {\n    var self = this;\n\n    if (self.doubtsContainer().length <= 0) return;\n\n    self.expandButton().on('click', function () {\n      self.expandButton().hide();\n      self.form().slideDown('fast');\n    });\n\n    self.hideButton().on('click', function () {\n      self.form().slideUp('fast', function () {\n        self.expandButton().fadeIn('fast');\n      });\n    });\n\n    self.loadMoreButton().on('click', function () {\n      self.page = self.page + 1;\n      var $btn = $(this);\n\n      $btn.attr('disabled', 'disabled');\n      self.loadDoubts(function () {\n        $btn.removeAttr('disabled');\n      });\n    });\n\n    self.loadDoubts();\n  }\n};\n\n(function () {\n  'use strict';\n\n  app.changeTimeZone = function () {\n    $('.js-to-client-timezone').each(function (i, el) {\n      var $el = $(el);\n      var format = $el.data('format');\n      var zone = moment.tz.guess();\n      var time = $el.data('timezone');\n\n      $el.html(moment.tz(time, zone).format(format));\n    });\n\n    $(document).trigger('app:change:timezone');\n  };\n\n  // TODO: FIXME: Essa chamada é para funcionar no primeiro load. Não deveria\n  // ser assim, parece ser algum erro com a inserção de cod no tema\n  app.changeTimeZone();\n})();\n\n(function () {\n  $(document).on('page:load', function () {\n    app.init();\n  });\n\n  $(document).on('page:partial-load', function () {\n    app.bindBlazy();\n  });\n\n  $(document).ready(function () {\n    app.init();\n  });\n})();","(function () {\n  'use strict';\n\n  window.app = {\n    bindGlobal: function () {\n      FastClick.attach(document.body);\n\n      $('.timeago').timeago();\n\n      $(document).trigger('app:bind:global');\n    },\n\n    bindOpenOnLoad: function () {\n      var toOpen = $('.js-open-on-load');\n      if (toOpen.length > 0) {\n        $.each(toOpen, function (i, elem) {\n          window.open($(elem).attr('href'));\n        });\n      }\n\n      $(document).trigger('app:bind:open_on_load');\n    },\n\n    bindTooltips: function () {\n      $(\"[data-toggle='tooltip']\")\n        .tooltip(\"destroy\")\n        .tooltip();\n\n      $(document).trigger('app:bind:tooltips');\n    },\n\n    checkFormValidity: function (event) {\n      var form = event.currentTarget;\n      var submitButton = $(form).find('button[type=\"submit\"]');\n\n      if (form.checkValidity()) {\n        submitButton.removeAttr('disabled');\n      } else {\n        submitButton.attr('disabled', 'disabled');\n      }\n\n      $(document).trigger('app:bind:check_form_validity');\n    },\n\n    init: function () {\n      $(document).on('scroll', function () {\n        var scrollTop = $(document).scrollTop();\n        var $body = $('body');\n\n        if (scrollTop > 0 && !$body.hasClass('scrolled')) {\n          $body.addClass('scrolled');\n        } else if (scrollTop <= 0 && $body.hasClass('scrolled')) {\n          $body.removeClass('scrolled');\n        }\n      });\n\n      app.pagarme.init();\n      app.bindGlobal();\n      app.bindBlazy();\n      app.bindOpenOnLoad();\n      app.bindHome();\n      app.bindProduct();\n      app.bindMasks();\n      app.bindTooltips();\n      app.bindReadMore();\n      app.bindDatepicker();\n      app.bindFixOnScroll();\n      app.ckeditor.bindCkeditor();\n      app.bindCheckout();\n      app.lessonList.init();\n      app.chat.init();\n      app.studentDoubts.init();\n      app.notepad.init();\n      app.categoryList.init();\n      app.bindExamQuestionForm();\n      app.changeTimeZone();\n      app.followBind();\n      app.lessonPage();\n      app.bindPostsForm();\n\n      $(document).on('app:bind:ckeditor_submit', app.bindCollaborativeDiscussion);\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.bindBlazy = function (e) {\n    new Blazy();\n\n    $(document).trigger('app:bind:blazy');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.categoryList = {\n    init: function () {\n      var self = this;\n      self.$categoryList = $('#js-category-list');\n\n      if (self.$categoryList.length == 0) return;\n\n      self.isActive = self.$categoryList.data('is-active') || self.isActive;\n\n      if (!self.isActive) {\n        self.bindClicks();\n        self.$categoryList.attr('data-is-active', true);\n        self.isActive = true;\n      }\n\n      self.expandParents();\n    },\n\n    bindClicks: function () {\n      var self = this;\n\n      $(document).on('click', '#js-category-list .category-item .toggle-btn', function () {\n        self.expandParent($(this).parent('.category-item'), true);\n      });\n    },\n\n    expandParent: function ($parent, animate) {\n      var $nextListGroup = $parent.find('.list-group').first();\n      var $parentCategoryItem = $parent;\n\n      if (animate) {\n        $nextListGroup.stop().slideToggle('fast');\n      } else {\n        $nextListGroup.stop().toggle();\n      }\n\n      $parentCategoryItem.toggleClass('expanded');\n    },\n\n    expandParents: function () {\n      var self = this;\n      var $loopItem = self.$categoryList.find('.category-item.current').first();\n\n      while ($loopItem) {\n        self.expandParent($loopItem, false);\n\n        var $parent = $loopItem\n          .parents('.category-item')\n          .first();\n\n        if ($parent.length > 0) {\n          $loopItem = $parent;\n        } else {\n          $loopItem = null;\n        }\n      }\n    }\n  }\n\n})();\n","(function () {\n  'use strict';\n\n  app.chat = {\n    groupsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n    collaboratorsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n    followsPagination: {\n      page: 0,\n      perPage: 5,\n      totalPages: 0\n    },\n\n    init: function () {\n      var self = this;\n\n      self.$chat = $('.js-chat');\n      self.$groups = $('.js-groups');\n      self.$roomTitle = $(\"#js-room-title\");\n      self.$roomUsersCount = $(\"#js-room-users-count\");\n      self.$text = $('.js-chat-text');\n      self.$messagesContainer = $('.js-chat-messages .js-content');\n      self.$messagesScroll = $('.js-chat-messages .js-scroll');\n      self.$sendForm = $('#js-send-messages');\n      self.$loadMoreGroupsButton = self.$chat.find('.js-load-more-groups');\n      self.$loadMoreCollaboratorsButton = self.$chat.find('.js-load-more-collaborators');\n      self.$loadMoreStudentsButton = self.$chat.find('.js-load-more-students');\n      self.$generalChatGroup = self.$chat.find('.js-chat-group-general');\n\n      self.user = $(\"#school-header\").data('user');\n\n      if(!self.user) {\n        return;\n      }\n\n      self.schoolId = self.$chat.data('school-id');\n      self.apiKey = self.$chat.data('api-key');\n      self.userId = self.user.id;\n\n      if (self.$chat.length <= 0) return;\n\n      self.bindScroll();\n\n      self.$messagesContainer.empty();\n\n      // bind form\n      self.$text.keyup(function (e) {\n        var code = e.keyCode ? e.keyCode : e.which;\n        if (code === 13 && !e.shiftKey) {\n          self.submitMessage(e);\n        }\n      });\n\n      app.simpleEditor.init('#js-send-messages');\n      self.$sendForm.on('submit', self.submitMessage);\n\n      firebase.initializeApp(window.CHAT_CONFIG);\n      self.database = firebase.database();\n\n      self.authenticate();\n\n      self.loadSchoolGroup(self.didLoadSchoolGroup);\n      self.loadGroups(self.didLoadGroups);\n      self.loadCollaborators(self.didLoadCollaborators);\n      self.loadFollows(self.didLoadFollows);\n\n      self.$loadMoreGroupsButton.on('click', function () {\n        self.loadGroups(self.didLoadGroups);\n      });\n\n      self.$loadMoreCollaboratorsButton.on('click', function () {\n        self.loadCollaborators(self.didLoadCollaborators);\n      });\n\n      self.$loadMoreStudentsButton.on('click', function () {\n        self.loadFollows(self.didLoadFollows);\n      });\n\n      self.$generalChatGroup.on('click', function () {\n        self.changeRoom({\n          currentTarget: self.$generalChatGroup\n        })\n      });\n\n      self.listenConnectionChanges();\n    },\n\n    authenticate: function () {\n      var self = app.chat;\n      $.ajax({\n        url: window.CHAT_FIREBASE_SERVICE_HOST + '/authenticate',\n        method: 'POST',\n        headers: {\n          'Authorization': self.apiKey\n        }\n      }).success(function (data) {\n        firebase.auth().signInWithCustomToken(data.body.firebase_token)\n          .then(function (response) {\n            self.monitorConnectionState(response);\n          })\n          .catch(function (error) {\n            console.error(\"Error creating custom token:\", error);\n          });\n      }).error(function (error) {\n        console.error('Could not authenticate');\n        console.error(error);\n      });\n    },\n\n    monitorConnectionState: function (response) {\n      const self = app.chat;\n      const userRef = firebase.database().ref(\"user_status\").child(response.uid);\n\n      // Monitor connection state on browser tab\n      firebase.database().ref(\".info/connected\")\n        .on(\"value\", function (snap) {\n          if (snap.val()) {\n            // if we lose network then remove this user from the list\n            userRef.onDisconnect().set(\"offline\");\n            // set user's online status\n            userRef.set(\"online\");\n          }\n        });\n\n      document.onIdle = function () {\n        userRef.set(\"idle\");\n      };\n\n      document.onAway = function () {\n        userRef.set(\"away\");\n      };\n\n      document.onBack = function (isIdle, isAway) {\n        userRef.set(\"online\");\n      }\n    },\n\n    listenConnectionChanges: function () {\n      var self = app.chat;\n      var connectionsRef = this.database.ref(\"user_status\");\n\n      connectionsRef.on('child_added', function (data) {\n        self.updateStatus(data.val(), data.key);\n      });\n\n      connectionsRef.on('child_changed', function (data) {\n        self.updateStatus(data.val(), data.key);\n      });\n\n      connectionsRef.on('child_removed', function (data) {\n        self.updateStatus(data.val(), 'offline');\n      });\n    },\n\n    updateStatus: function (status, user_id) {\n      var $element = $('*[data-id=\"' + user_id + '\"]')[0];\n      if ($element) {\n        $('.status > .icon', $element).first().attr('class', 'icon icon-' + status);\n      }\n    },\n\n    bindScroll: function () {\n      var height = this.$chat.data('height');\n      var parent = this.$chat.data('parent');\n      var parentHeight = parent ? $(parent).height() : $(window).height();\n      var isPercentHeight = height.indexOf('%') > -1;\n      height = Number(height.replace('%', '').replace('px', ''));\n\n      if (isPercentHeight === true) {\n        this.chatHeight = (parentHeight / 100) * height;\n      } else {\n        this.chatHeight = height;\n      }\n\n      this.$chat.height(this.chatHeight);\n      this.$chat.find('.js-sidebar-scroll').scrollbar({});\n      this.$chat.find('.js-chat-messages .js-scroll').scrollbar({});\n    },\n\n    loadMessages: function () {\n      var self = app.chat;\n      const setMessage = function (data) {\n        self.insertMessage(data.val());\n      }.bind(self);\n\n      self.messages.limitToLast(12).on('child_added', setMessage);\n      self.messages.limitToLast(12).on('child_changed', setMessage);\n    },\n\n    sanitizeHtml: function ($root) {\n      $root.find('div:empty').remove();\n\n      // Removes elements with only '<br/>' children\n      $root.children().each(function (i, el) {\n        var $el = $(el);\n        if (el.tagName !== 'BR' && $el.find('br').length > 0 && $el.find('br').length == $el.children().length) {\n          $el.remove();\n        }\n      });\n\n      // Removes last '<br/>'\n      if ($root.last().get(0).tagName === 'BR') {\n        $root.last().remove();\n      }\n\n      return $root;\n    },\n\n    submitMessage: function (event) {\n      event.preventDefault();\n      var self = app.chat;\n\n      var $html = self.sanitizeHtml(self.$text);\n      var text = $html.html();\n\n      if (text.length <= 0) return;\n\n      self.$text.html('').focus();\n\n      function pad(n) {\n        return (n < 10) ? (\"0\" + n) : n;\n      }\n\n      var date = new Date();\n\n      self.messages.push({\n        id: self.user.id,\n        name: self.user.name,\n        avatar_url: self.user.avatar_url,\n        text: text,\n        timestamp: moment().unix(),\n        schedule: pad(date.getHours()) + ':' + pad(date.getMinutes())\n      });\n    },\n\n    insertMessage: function (data) {\n      var self = app.chat;\n      var html = self.renderTemplate('chat-message', {\n        avatar: data.avatar_url,\n        name: data.name,\n        text: data.text,\n        schedule: moment.unix(data.timestamp).format('LLL')\n      });\n\n      self.$messagesContainer.append(html);\n      self.scrollToEnd();\n    },\n\n    scrollToEnd: function () {\n      var self = this;\n      self.$messagesScroll.scrollTop(self.$messagesScroll[0].scrollHeight);\n    },\n\n    renderTemplate: function (key, data) {\n      var liquid = $('#' + key + '-template').html();\n      var template = Liquid.parse(liquid);\n\n      return template.render(data);\n    },\n\n    loadSchoolGroup: function (callback) {\n      var self = app.chat;\n      $.ajax({\n        url: window.CORE_HOST + '/chat/school_group',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        callback(data);\n      });\n    },\n\n    loadGroups: function (callback) {\n      var self = app.chat;\n      self.$loadMoreGroupsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/groups?per_page=' + self.groupsPagination.perPage + '&page=' + (self.groupsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.groupsPagination.page = self.groupsPagination.page + 1;\n        self.$loadMoreGroupsButton.removeAttr('disabled', 'disabled');\n        callback(data);\n      });\n    },\n\n    loadCollaborators: function (callback) {\n      var self = app.chat;\n      self.$loadMoreCollaboratorsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/collaborators?per_page=' + self.collaboratorsPagination.perPage + '&page=' + (self.collaboratorsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.collaboratorsPagination.page = self.collaboratorsPagination.page + 1;\n        self.$loadMoreCollaboratorsButton.removeAttr('disabled', 'disabled');\n        callback(data);\n      });\n    },\n\n    loadFollows: function (callback) {\n      var self = app.chat;\n      self.$loadMoreStudentsButton.attr('disabled', 'disabled');\n\n      $.ajax({\n        url: window.CORE_HOST + '/chat/follows?per_page=' + self.followsPagination.perPage + '&page=' + (self.followsPagination.page + 1),\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        }\n      }).success(function (data) {\n        self.followsPagination.page = self.followsPagination.page + 1;\n        self.$loadMoreStudentsButton.removeAttr('disabled', 'disabled');\n        callback(data);\n      });\n    },\n\n    didLoadSchoolGroup: function (group) {\n      var self = app.chat;\n\n      group.is_school = true;\n\n      var $html = $(self.renderTemplate('chat-group-list-item', group));\n      $html.on('click', app.chat.changeRoom);\n      self.$groups.prepend($html);\n    },\n\n    didLoadGroups: function (data) {\n      var self = app.chat;\n\n      self.groupsPagination.totalPages = data.total_pages;\n\n      if (self.groupsPagination.page >= self.groupsPagination.totalPages) {\n        self.$loadMoreGroupsButton.attr('disabled', 'disabled');\n      }\n\n      var groups = data.groups;\n      groups = _.sortBy(groups, {is_school: false});\n      groups = _.map(groups, function (g) {\n        g.is_school = false;\n        return g;\n      });\n\n      groups.forEach(function (group) {\n        var $html = $(self.renderTemplate('chat-group-list-item', group));\n        $html.on('click', app.chat.changeRoom);\n        self.$groups.append($html);\n      });\n\n      self.selectFirstRoomAvailable();\n    },\n\n    didLoadCollaborators: function (data) {\n      var self = app.chat;\n\n      self.collaboratorsPagination.totalPages = data.total_pages;\n\n      if (self.collaboratorsPagination.page >= self.collaboratorsPagination.totalPages) {\n        self.$loadMoreCollaboratorsButton.attr('disabled', 'disabled');\n      }\n\n      self.addProfileItems(data.collaborators, 'js-team');\n      self.selectFirstRoomAvailable();\n    },\n\n    didLoadFollows: function (data) {\n      var self = app.chat;\n      self.followsPagination.totalPages = data.total_pages;\n\n      if (self.followsPagination.page >= self.followsPagination.totalPages) {\n        self.$loadMoreStudentsButton.attr('disabled', 'disabled');\n      }\n\n      self.addProfileItems(data.users, 'js-students');\n      self.selectFirstRoomAvailable();\n    },\n\n    addProfileItems: function (users, divClass) {\n      var self = app.chat;\n\n      users.forEach(function (user) {\n        var $html = $(self.renderTemplate('chat-profile-list-item', user));\n        $html.on('click', app.chat.changeRoom);\n        $('.' + divClass).append($html);\n      });\n    },\n\n    changeRoom: function (event) {\n      var self = app.chat;\n      var $element = $(event.currentTarget);\n\n      $(\".chat-sidebar-list-item\").removeClass('active');\n      $element.addClass('active');\n\n      var roomName = 'messages';\n\n      if ($element.data('type') === 'products') {\n        // room name on firebase\n        roomName += '_products/' + $element.data('id');\n\n        // change room name on div\n        self.$roomTitle.html($('.js-chat-group-name', $element).html());\n        self.$roomUsersCount.html($('.js-chat-group-users-count', $element).html());\n      } else if ($element.data('type') === 'users') {\n        var ids = [self.userId, parseInt($element.data('id'))].sort();\n        roomName += '_users/' + ids[0] + '/' + ids[1];\n\n        // change room name on div\n        self.$roomTitle.html($('.info .name', $element).html());\n        self.$roomUsersCount.html($('.info .location', $element).html());\n      } else if ($element.data('type') === 'schools') {\n        // room name on firebase\n        roomName += '_schools/' + self.schoolId;\n\n        // change room name on div\n        self.$roomTitle.html($('.js-chat-group-name', $element).html());\n        self.$roomUsersCount.html($('.js-chat-group-users-count', $element).html());\n      }\n\n      self.$messagesContainer.html('');\n\n      if (self.messages) {\n        self.messages.off();\n      }\n\n      self.messages = self.database.ref(roomName);\n      self.loadMessages();\n    },\n\n    selectFirstRoomAvailable: function () {\n      if (!self.$selectedRoom) {\n        // Select first room\n        self.$selectedRoom = $(\".chat-sidebar-list-item\").first();\n        self.$selectedRoom.click();\n      }\n    }\n  }\n\n})();\n","(function () {\n  'use strict';\n\n  app.bindCheckout = function () {\n    $('#js-terms-of-use-check').change(function () {\n      if ($(this).is(\":checked\") === true) {\n        $('.cta-checkout-cart').removeClass('disabled');\n      } else {\n        $('.cta-checkout-cart').addClass('disabled');\n      }\n    });\n\n    $(document).trigger('app:bind:checkout');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.ckeditor = {\n    bindCkeditor: function () {\n      var src = '//cdn.edools.com/libs/ckeditor/4.5.10/ckeditor.js';\n\n      if ($('.js-ckeditor').length) {\n        loadAsset('window.CKEDITOR', src, function () {\n          var config = {\n            language: 'pt-br',\n            skin: 'bootstrapck'\n          };\n\n          $('.js-ckeditor').each(function (index, ckeditorObj) {\n            if (!$('#cke_' + ckeditorObj.id).length) {\n              config.placeholder = ckeditorObj.placeholder; // TODO: fix it\n\n              CKEDITOR.replace(ckeditorObj.id, config);\n            }\n          });\n\n          app.ckeditor.bindCkeditorSubmit();\n          $(document).trigger('app:bind:ckeditor');\n        });\n      }\n    },\n\n    bindCkeditorSubmit: function () {\n      $.each($('.js-ckeditor'), function (index, editor) {\n        var $editor = $(editor);\n        var $form = $editor.parents('form');\n        var editorId = $editor.attr('id');\n\n        if ($form) {\n          var $submitButton = $form.find('button[type=\"submit\"]');\n\n          CKEDITOR.instances[editorId].on('change', function () {\n            if (this.getData().length) {\n              $submitButton.attr('disabled', false);\n            } else {\n              $submitButton.attr('disabled', true);\n            }\n          });\n        }\n      });\n\n      $(document).trigger('app:bind:ckeditor_submit');\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.bindCollaborativeDiscussion = function() {\n    $(document).on('click', '#collaborative-discussion .js-edit-button' ,function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').addClass('hide');\n      $comment.find('.js-edit-container').removeClass('hide');\n    });\n\n    $(document).on('click', '#collaborative-discussion .js-cancel-button' ,function () {\n      var commentId = $(this).data('comment-id');\n      var $comment = $('#js-comment-' + commentId);\n\n      $comment.find('.js-show-comment').removeClass('hide');\n      $comment.find('.js-edit-container').addClass('hide');\n    });\n\n\n    $(document).trigger('app:bind:collaborative_discussion');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindDatepicker = function () {\n    // TODO: Handle i18n\n    $.fn.datepicker.defaults.language = 'pt-BR';\n\n    $('.datepicker').each(function (i, el) {\n      var $el = $(el);\n      var $hidden = $('<input type=\"hidden\" />').insertBefore($el.parent());\n      var frontDate = moment($el.val()).utc().format('DD/MM/YYYY');\n      var serverDate = moment($el.val()).utc().format('YYYY-MM-DD');\n      serverDate = (serverDate === 'Invalid date') ? null : serverDate;\n\n      $hidden.attr('id', $el.attr('id'));\n      $hidden.attr('name', $el.attr('name'));\n      $hidden.attr('value', serverDate);\n\n      $el.removeAttr('id');\n      $el.removeAttr('name');\n\n      if ($el.val() !== \"\") {\n        $el.val(frontDate);\n      }\n\n      $(el).datepicker()\n        .on('change', function () {\n          var date = moment($el.val(), 'DD/MM/YYYY').utc().format('YYYY-MM-DD');\n          date = (date === 'Invalid date') ? null : date;\n          $hidden.val(date);\n        });\n    });\n\n    $(document).trigger('app:bind:datepicker');\n  };\n\n})();\n","(function () {\n  'use strict';\n\n  app.bindExamQuestionForm = function () {\n    $(document).on('click', '#js-remake-exam', function () {\n      $('#answers-container').addClass('hide');\n      $('#form-container').removeClass('hide');\n    });\n\n    $(document).on('click', '.js-clean-associative-options', function () {\n      $(this).parents('.associative-question')\n        .find('.js-associative-select option:selected')\n        .removeAttr('selected')\n    });\n\n    $(document).on('change', '.js-associative-select', function () {\n      var $question = $(this).parents('.associative-question');\n      var optionIndex = $(this).data('option-index');\n      var assertionId = $(this).find('option:selected').data('first-assertion-id');\n\n      $question.find('.js-associate-assertion[data-option-index=\"' + optionIndex + '\"]').val(assertionId);\n    });\n\n    // bind all form's inputs\n    $(document).on('change', '#exam_answer_form', app.checkFormValidity);\n    // bind all form's textareas for all types of typing\n    $(document).on('input propertychange', '#exam_answer_form', app.checkFormValidity);\n\n    $(document).trigger('app:bind:bind_exam_question_form');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindFixOnScroll = function () {\n    $('.js-fix-on-scroll').each(function (i, el) {\n      if (!$(el).hasClass('js-fix-on-scroll-mobile') && window.innerWidth < 992) {\n        return;\n      }\n\n      var $el = $(el);\n      $el.wrap('<div class=\"js-fix-scroll-wrapper\"/>');\n      var $wrapper = $el.parent('.js-fix-scroll-wrapper');\n\n      var offset = $el.offset();\n      var size = {\n        width: $el.outerWidth(),\n        height: $el.outerHeight()\n      };\n\n      $wrapper.width(size.width);\n      $wrapper.height(size.height);\n\n      $(document).on('scroll', function (e) {\n        var scrollTop = $(document).scrollTop();\n\n        if (scrollTop >= offset.top) {\n          if ($el.css('position') === 'fixed') return;\n\n          $el.parent().addClass('scroll');\n          $el.addClass('scroll');\n          $el.css({\n            position: 'fixed',\n            left: offset.left,\n            top: 0,\n            width: size.width,\n            height: size.height,\n            'z-index': '10000'\n          });\n        } else {\n          if ($el.css('position') === 'static') return;\n\n          $el.removeClass('scroll');\n          $el.parent().removeClass('scroll');\n          $el.css({\n            position: 'static',\n            left: 'auto',\n            top: 'auto',\n            width: 'auto',\n            height: 'auto'\n          });\n        }\n      })\n\n    });\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.followBind = function () {\n    $(document).on({\n        mouseenter: function(){\n          $(this).addClass('hidden');\n          $('#js-unfollow').removeClass('hidden');\n        }\n    }, '#js-following');\n\n    $(document).on({\n        mouseleave: function(){\n          $('#js-following').removeClass('hidden');\n          $(this).addClass('hidden');\n        }\n    }, '#js-unfollow');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindHome = function () {\n    $('.js-hero-slider').owlCarousel({\n      items: 1,\n      loop: true,\n      autoplay: true,\n      autoplayTimeout: 7000,\n      dots: false,\n      nav: false\n    });\n\n    $('.js-hero-videos-slider').owlCarousel({\n      items: 3,\n      loop: true,\n      dots: true,\n      nav: false,\n      margin: 5\n    });\n\n    $('.js-hero-videos .js-videos-nav a').on('click', function (e) {\n      e.preventDefault();\n\n      var $el = $(this);\n      var $html = $($el.data('html'));\n\n      $('.js-hero-videos .js-video-container').html($html);\n    });\n  }\n\n})();\n","(function () {\n  'use strict';\n\n  app.lessonList = {\n    init: function () {\n      var self = this;\n\n      self.courseTreeExists = self.courseTree().length;\n      self.isActive = self.courseTree().data('is-active');\n      self.course = self.courseTree().data('course');\n      self.enrollment = self.courseTree().data('enrollment');\n      self.courseContent = self.courseTree().data('course-content');\n      self.userType = self.courseTree().data('user-type');\n      self.lessonActions = self.courseTree().data('lesson-actions');\n      self.downloadAction = self.courseTree().data('download-action');\n      self.currentLessonId = parseInt(self.courseTree().data('current-lesson-id'));\n      self.apiKey = self.courseTree().data('api-key');\n\n      self.translations = {};\n      self.translations['lesson.release_at'] = self.courseTree().data('translation-release-at');\n      self.translations['lesson.release_after'] = self.courseTree().data('translation-release-after');\n      self.translations['product.course_content.views'] = self.courseTree().data('translation-course_content-views');\n\n      if (self.lessonProgress() && self.lessonProgress().completed) {\n        $('.btn-next-lesson').removeClass('disabled');\n      }\n\n      if (self.courseTreeExists && !self.isActive) {\n        self.bindClicks();\n        self.handleLessons();\n        self.loadTopModules();\n        self.bindChangeLesson();\n\n        $(document).trigger('app:bind:lesson_sidebar');\n\n        $(document).on('lesson-completed', function (event, lessonProgress) {\n          var $mediaControls = $('.btn-next-lesson');\n          var enrollmentId = lessonProgress.data.enrollment_id;\n\n          if (self.progressIcon('completed').hasClass('hide')) {\n            self.progressIcon('completed').removeClass('hide');\n          }\n\n          if (!self.progressIcon('progress').hasClass('hide')) {\n            self.progressIcon('progress').addClass('hide');\n          }\n\n\n          if ($mediaControls.size() > 0) {\n            $mediaControls.removeClass('disabled');\n          }\n\n          app.lessonList.requirementsExists(lessonProgress.data, function ($item, content_id) {\n            if ($item && content_id) {\n              app.lessonList.checkLessonCompleted(enrollmentId, content_id, function (completed) {\n                if (completed) {\n                  $item.removeClass('blocked');\n                  $item.find('.right > .icon-lock').remove();\n                }\n              });\n            }\n          });\n        });\n      }\n    },\n\n    // Props\n\n    courseTree: function () {\n      return $('.course-content #js-course-tree-ajax');\n    },\n\n    lazyLoadButtons: function () {\n      return $('.course-content #js-course-content-more-link, .course-content #js-course-content-prev-link');\n    },\n\n    lessons: function () {\n      return this.courseTree().find('.js-content');\n    },\n\n    currentLesson: function () {\n      return $(this.courseTree().find('.js-content.active')[0]);\n    },\n\n    toggleButton: function () {\n      return $('.lesson-list-toggle .btn');\n    },\n\n    lessonListPanel: function () {\n      return $('.lesson-list-panel');\n    },\n\n    lessonProgress: function () {\n      return $('#js-media-player').data('lesson-progress');\n    },\n\n    progressIcon: function (type) {\n      var iconType = {\n        completed: '.js-completed-icon',\n        progress: '.js-in-progress-icon'\n      };\n\n      return this.currentLesson().find(iconType[type]);\n    },\n\n    requirementsExists: function (lessonProgress, cb) {\n      if (!lessonProgress) {\n        return false;\n      }\n\n      var requirementsElements = $('.lesson-list-panel [data-requirements]')\n        .filter(function (index, item) {\n          return $(item).data('requirements').length > 0;\n        });\n\n      var requirementsUnified = requirementsElements.map(function (idx, item) {\n        return {\n          item: $(item),\n          requirements: $(item).data('requirements')\n        }\n      }).toArray();\n\n      var exists = _.find(requirementsUnified, {requirements: [{content_id: lessonProgress.lesson_id}]});\n\n      if (exists) {\n        var $item = exists.item;\n        if (cb) {\n          return cb($item, lessonProgress.lesson_id);\n        }\n      } else {\n        if (cb) {\n          return cb(null);\n        }\n      }\n    },\n\n    checkLessonCompleted: function (enrollmentId, id, cb) {\n      var self = this;\n      var completed = false;\n      var apiKey = $('.course-content #js-course-tree-ajax').data('api-key');\n\n      $.ajax({\n        url: window.CORE_HOST + '/enrollments/' + enrollmentId + '/lessons_progresses?lesson_id=' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + apiKey\n        }\n      }).success(function (data) {\n        completed = data.lessons_progresses[0].completed;\n\n        cb(completed);\n      });\n    },\n\n    // Actions\n    bindChangeLesson: function () {\n      var self = this;\n\n      if (!self.bindChangeLessonActive) {\n        self.bindChangeLessonActive = true;\n        var course_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+$/;\n        var lesson_path_regex = /enrollments\\/\\d+\\/courses\\/\\d+\\/course_contents\\/\\d+$/;\n\n        $(document).on(\"ready page:load\", function (e) {\n          var path = window.location.pathname;\n          var lesson_path = lesson_path_regex.test(path);\n\n          if (course_path_regex.test(path) || lesson_path) {\n            self.lessons().removeClass('active');\n\n            if (lesson_path) {\n              var path_array = path.split('/');\n              var content_id = path_array[path_array.length - 1];\n\n              $(\"#content-\" + content_id + \".js-content\").addClass('active');\n            }\n          }\n        })\n      }\n    },\n\n    bindClicks: function () {\n      var self = this;\n\n      self.lessons().find('a').on('click', function (e) {\n        e.preventDefault();\n        app.lessonList.changeLesson(null, $(this).parents('.js-content'));\n      });\n\n      self.courseTree().on('click', '.module', function (e) {\n        if (!$(e.target).hasClass('module') && !$(e.target).parent().hasClass('module')) {\n          return;\n        }\n\n        e.stopPropagation();\n\n        self.loadChildren($(this));\n      });\n\n      self.courseTree().data('is-active', true);\n\n      self.toggleButton().on('click', this.toggleSidebar);\n    },\n\n    getLessonIcon: function (lesson) {\n      var lessonIcon = '';\n\n      if (lesson.type === 'ExamLesson' && lesson.activity) {\n        switch (lesson.activity.type) {\n          case 'Quiz': {\n            lessonIcon = '-puzzle';\n            break;\n          }\n          case 'FileUpload': {\n            lessonIcon = 'icon-arrow-up-circle';\n            break;\n          }\n          case 'CollaborativeDiscussion': {\n            lessonIcon = 'icon-people';\n            break;\n          }\n          default: {\n            lessonIcon = 'icon-puzzle'\n          }\n        }\n      } else if (lesson.media) {\n        switch (lesson.media.type) {\n          case 'Video': {\n            lessonIcon = 'icon-camrecorder';\n            break;\n          }\n          case 'Audio': {\n            lessonIcon = 'icon-microphone';\n            break;\n          }\n          case 'Slide': {\n            lessonIcon = 'icon-chart';\n            break;\n          }\n          case 'Document': {\n            lessonIcon = 'icon-doc';\n            break;\n          }\n          case 'Image': {\n            lessonIcon = 'icon-picture';\n            break;\n          }\n          case 'Text': {\n            lessonIcon = 'icon-doc';\n            break;\n          }\n          case 'LiveStream': {\n            lessonIcon = 'icon-control-play';\n            break;\n          }\n          case 'VideoSlide': {\n            lessonIcon = 'icon-film';\n            break;\n          }\n          case 'ScormPackage': {\n            lessonIcon = 'icon-layers';\n            break;\n          }\n          case 'Html': {\n            lessonIcon = 'icon-doc';\n            break;\n          }\n          case 'Html5': {\n            lessonIcon = 'icon-docs';\n            break;\n          }\n          default: {\n            lessonIcon = 'icon-camrecorder';\n          }\n\n        }\n      }\n\n      return lessonIcon;\n    },\n\n    getContentPath: function (content) {\n      var self = this;\n\n      var enrollmentId = self.enrollment.id;\n      var courseId = self.course.id;\n\n      var path = enrollmentId ? '/enrollments/' + enrollmentId : '/admin_view';\n      path = path + '/courses/' + courseId + '/course_contents/' + content.id;\n\n      return path;\n    },\n\n    getContentDownloadPath: function (content) {\n      var self = this;\n      return self.getContentPath(content) + '/download';\n    },\n\n    checkLessonAvailability: function (lesson) {\n      var releaseAt = lesson.release_at;\n      var releaseAfter = lesson.release_after;\n\n      if (!releaseAt && !releaseAfter) {\n        return true;\n      }\n\n      var enrollmentActivatedAt = moment(this.enrollment.activated_at);\n\n      var releaseTime = releaseAt ? moment(releaseAt) : enrollmentActivatedAt.add(releaseAfter, 'days');\n\n      return moment() > releaseTime;\n    },\n\n    checkTrialByType: function (type, id) {\n      var $tree = $('#js-course-tree-ajax');\n      var enrollment = $tree.data('enrollment');\n      var constrains_name = 'trial_' + type + '_ids';\n\n      var payment_method = enrollment && enrollment.payment_method;\n      var constrains_tree = $tree.data('school-product') && $tree.data('school-product').trial_constrains;\n      var constrains = constrains_tree && payment_method && constrains_tree[payment_method];\n\n      if (constrains && !constrains.hasOwnProperty(constrains_name)) {\n        return false;\n      }\n\n      if (enrollment && !enrollment['on_trial?']) {\n        return false;\n      }\n\n      if (constrains_tree && constrains[constrains_name]) {\n        return constrains[constrains_name].indexOf(id) > -1;\n      }\n\n      return false;\n    },\n\n    fetchModules: function ($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id,\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function (res) {\n          var modules = _.sortBy(res.course_modules, 'order');\n\n          modules = _.filter(modules, function (m) {\n            var module = _.find(self.allModules, {id: m.id});\n            return module.available !== false && (module.course_content_ids.length > 0 || module.course_modules.length > 0);\n          });\n\n          var $modules = _.map(modules, function (module) {\n            return $(\n              '<li class=\"list-group-item module\" ' +\n              'data-id=\"' + module.id + '\"' +\n              'data-level=\"' + (level + 1) + '\">' +\n              '<i class=\"icon icon-arrow-right\"></i>' +\n              '<span>' + module.name + '</span>' +\n              '<i class=\"busy busy-xs\"></i>' +\n              '</li>');\n          });\n\n          $list.append($modules);\n        }\n      })\n    },\n\n    fetchChildren: function ($parent) {\n      var self = this;\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      return $.ajax({\n        url: window.CORE_HOST + '/course_modules/' + id + '/course_contents',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function (res) {\n          var courseContents = _.filter(res.course_contents, function (lesson) {\n            return lesson.available !== false;\n          });\n\n          courseContents = _.sortBy(courseContents, 'order');\n\n          if (self.enrollment) {\n            courseContents = _.map(courseContents, function (content) {\n              content.completed = self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(content.lesson.id) > -1;\n              return content;\n            });\n          }\n\n          var $courseContents = _.map(courseContents, function (content) {\n              var active = (self.currentLessonId === content.lesson.id ? 'active js' : '');\n              var lesson = content.lesson;\n              var lessonIcon = self.getLessonIcon(lesson);\n              var hideInProgressIcon = 'hide';\n              var hideCompletedIcon = 'hide';\n              var lessonReleased = null;\n              var releaseType = null;\n              var releaseDate = null;\n              var progress = null;\n              var requirements = content.requirements;\n              var available = true;\n              var requirements_ids = requirements.map(function (item) {\n                return item.content_id;\n              });\n\n              if (self.enrollment) {\n                lessonReleased = self.checkLessonAvailability(lesson);\n\n                if (self.enrollment.lessons_info && self.enrollment.lessons_info.completed.indexOf(lesson.id) > -1) {\n                  hideInProgressIcon = 'hide';\n                  hideCompletedIcon = null;\n                } else {\n                  if (self.enrollment.lessons_info && self.enrollment.lessons_info.in_progress.indexOf(lesson.id) > -1) {\n                    hideInProgressIcon = null;\n                    hideCompletedIcon = 'hide';\n                  } else {\n                    hideInProgressIcon = 'hide';\n                    hideCompletedIcon = 'hide';\n                  }\n                }\n\n                if (lesson.release_at) {\n                  releaseType = 'release_at';\n                  releaseDate = lesson.release_at;\n                } else if (lesson.release_after) {\n                  releaseType = 'release_after';\n                  releaseDate = moment(self.enrollment.activated_at).add(lesson.release_after, 'days');\n                }\n\n                if (self.lessonActions) {\n                  progress = _.find(self.enrollment.lessons_progresses, {lesson_id: lesson.id});\n                }\n              }\n\n              if (self.enrollment) {\n                _.each(requirements_ids, function (id) {\n                  var exists = _.find(courseContents, {content_id: id, completed: true});\n\n                  if (!exists) {\n                    available = false;\n                  }\n                });\n              }\n\n              if (content.completed) {\n                $('.btn-next-lesson').removeClass('disabled');\n              }\n\n              var html = '<li class=\"list-group-item content-lesson js-content list-group-item lesson module-item ' + active + (!available || (self.enrollment && self.checkTrialByType('content', content.id)) ? ' blocked' : '') + '\" ' +\n                'id=\"content-' + content.id + '\" ' +\n                'data-requirements=\\'' + JSON.stringify(requirements) + '\\'' +\n                'data-id=\"' + content.lesson.id + '\"' +\n                'data-level=\"1\">' +\n                '<div id=\"lesson-' + lesson.id + '\" class=\"js-lesson content-lesson ' + active + (!lessonReleased ? ' not-released' : '') + '\" data-lesson-id=\"' + lesson.id + '\">' +\n                '<div class=\"class-info\">' +\n\n                '<div class=\"left\"><i class=\"' + lessonIcon + '\"></i></div>' +\n\n                '<div class=\"center\">' +\n                (self.lessonActions && lessonReleased ?\n                  '<a class=\"lesson-title\" href=\"' + self.getContentPath(content) + '\"><span>' + lesson.title + '</span></a>' :\n                  '<span class=\"lesson-title\"><span class=\"disabled\">' + lesson.title + '</span></span>') +\n                '</div>' +\n\n                '<div class=\"right\">' +\n                ((!available || (self.enrollment && self.checkTrialByType('content', content.id))) ? '<i class=\"icon-lock\"></i>' : '') +\n                '<span class=\"progress-icon js-progress-icons\">' +\n                '<i class=\"icon-check js-completed-icon ' + hideCompletedIcon + '\"></i>' +\n                '<i class=\"icon-clock js-in-progress-icon ' + hideInProgressIcon + '\"></i>' +\n                '</span>';\n\n              if (self.lessonActions) {\n                if (progress && progress.views <= self.enrollment.max_attendance_length && self.enrollment.max_attendance_type == 'attempts') {\n                  var translation = self.translations['product.course_content.views'];\n\n                  translation = translation.replace('{{ progress.views }}', progress.views);\n                  translation = translation.replace('{{ enrollment.max_attendance_length }}', self.enrollment.max_attendance_length);\n\n                  html += '<span class=\"lesson-views attempt js-attendance badge\" title=\"' + translation + '\" data-tooltip-placement=\"left\" data-toggle=\"tooltip\">' +\n                    '<span>' + progress.views + '/' + self.enrollment.max_attendance_length + '</span>' +\n                    '</span>';\n                }\n\n                if (!lessonReleased) {\n                  var zone = moment.tz.guess();\n                  html += '<span class=\"release-date badge\">' + self.translations['lesson.' + releaseType] + '<span> ' + moment.tz(releaseDate, zone).format('DD/MM/YYYY') + '</span>' + '</span>';\n                }\n\n                if (self.downloadAction && content.downloadable) {\n                  html += '<a class=\"download-link\" href=\"' + self.getContentDownloadPath(content) + '\" data-no-turbolink>' +\n                    '<i class=\"icon-cloud-download\"></i>' +\n                    '</a>';\n                }\n              }\n\n              html += '</div>' +\n                '</div>' +\n                '</li>';\n\n              return $(html);\n            }\n          );\n\n          $list.append($courseContents);\n          self.checkNextButtonUnlocked();\n\n        }\n      });\n    },\n\n    checkNextButtonUnlocked: function () {\n      var lessonProgress = this.lessonProgress();\n\n      app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n        if ($item && content_id) {\n          if (!content_id || !lessonProgress.hasOwnProperty('enrollment_id')) {\n            return;\n          }\n\n          app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n            if (completed) {\n              $('.btn-next-lesson').removeClass('disabled');\n              $item.removeClass('blocked');\n              $item.find('.right > .icon-lock').remove();\n            }\n          });\n        }\n        else {\n          $('.btn-next-lesson').removeClass('disabled');\n        }\n      });\n    },\n\n    loadTopModules: function () {\n      var self = this;\n\n      if (!self.course) return;\n\n      $.ajax({\n        url: window.CORE_HOST + '/courses/' + self.course.id + '/course_modules',\n        method: 'GET',\n        headers: {\n          'Authorization': 'Token token=' + self.apiKey\n        },\n        success: function (res) {\n          if (!res.course_modules || res.course_modules.length <= 0) return;\n\n          self.allModules = res.course_modules;\n\n          self.topModules = _.filter(res.course_modules, function (x) {\n            return (!x.parent_course_module && x.available !== false) &&\n              (x.course_content_ids.length > 0 || x.course_modules.length > 0);\n          });\n\n          self.topModules = _.sortBy(self.topModules, 'order');\n\n          var $modules = _.map(self.topModules, function (module) {\n            var disabled = self.enrollment && self.checkTrialByType('module', module.id);\n\n            return $(\n              '<li class=\"list-group-item module ' + (disabled ? 'disabled' : '') + '\" ' +\n              'data-id=\"' + module.id + '\"' +\n              'data-level=\"1\">' +\n              '<i class=\"icon icon-arrow-right\"></i>' +\n              '<span>' + module.name + '</span>' +\n              '<i class=\"busy busy-xs\"></i>' +\n              '</li>');\n          });\n\n          self.courseTree().prev('.course-content-busy').fadeOut('fast', function () {\n            self.courseTree().css('display', 'none');\n            self.courseTree().html($modules);\n            self.courseTree().fadeIn('fast');\n\n            if (self.courseContent) {\n              self.expandParentModules(self.courseContent.parent_modules_hash);\n            }\n          });\n        }\n      })\n    },\n\n    loadChildren: function (parent, cb) {\n      var self = this;\n      var $parent = $(parent);\n\n      var id = $parent.data('id');\n      var level = $parent.data('level');\n      var $list = $parent.find('.list-group').first();\n\n      if ($list.length <= 0) {\n        $parent.find('.busy').css({opacity: 1});\n        $list = $('<ul class=\"list-group\" style=\"display: none;\"></ul>');\n        $list.appendTo($parent);\n\n        $.when(self.fetchModules($parent), self.fetchChildren($parent))\n          .then(function () {\n            $parent.addClass('expanded');\n            $parent.find('.busy').css({opacity: 0});\n\n            $list.slideDown('fast');\n\n            if (typeof cb === 'function') {\n              cb();\n            }\n          });\n      } else {\n        if ($parent.hasClass('expanded')) {\n          $parent.removeClass('expanded');\n          $list.slideUp('fast');\n        } else {\n          $parent.addClass('expanded');\n          $list.slideDown('fast');\n        }\n\n        if (typeof cb === 'function') {\n          cb();\n        }\n      }\n    },\n\n    handleLessons: function () {\n      $(document).on('page:load page:restore', function (e) {\n\n        if (!e.originalEvent || !e.originalEvent.data || e.originalEvent.data.length == 0) return;\n\n        var $html = $(e.originalEvent.data[0]);\n        app.lessonList.lessons().each(function (i, el) {\n          var $el = $(el);\n          var $new = $html.find('#' + $el.attr('id'));\n          $el.html($new.html());\n        });\n      })\n    },\n\n    changeLesson: function (direction, lesson) {\n      var $targetLesson = $(lesson);\n\n      if (direction === 'prev') {\n        var $prev = app.lessonList\n          .currentLesson()\n          .prevAll('.js-content');\n\n        if ($prev.length > 0 && $prev.find('a').length > 0)\n          $targetLesson = $($prev[0]);\n      } else if (direction === 'next') {\n        var $next = app.lessonList\n          .currentLesson()\n          .nextAll('.js-content');\n\n        if ($next.length > 0 && $next.find('a').length > 0)\n          $targetLesson = $($next[0]);\n      }\n\n      $targetLesson.find('a')[0].click();\n    },\n\n    expandParentModules: function (parentModules) {\n      var self = this;\n\n      var modules = [];\n      var loopModule = parentModules.course_module;\n      modules.push(loopModule.id);\n\n      while (loopModule.parent_module) {\n        loopModule = loopModule.parent_module;\n        modules.push(loopModule.id);\n      }\n\n      modules = modules.reverse();\n\n      async.eachSeries(modules, function (moduleId, cb) {\n        var $module = $('.module[data-id=\"' + moduleId + '\"]');\n        self.loadChildren($module, cb);\n      });\n\n    },\n\n    toggleSidebar: function () {\n      app.lessonList.toggleButton().toggleClass('active');\n      app.lessonList.lessonListPanel().toggleClass('active');\n    }\n  };\n\n})();\n","(function () {\n  'use strict';\n\n  app.lessonPage = function () {\n    var REGEX_COLLABORATIVE_DISCUSSIONS = /\\/collaborative_discussions\\/([0-9]+)\\/collaborative_comments/;\n    var REGEX_EXAM_ANSWERS = /\\/exam_answers/;\n\n    var isCollaborativeDiscuttion = function (value) {\n      return REGEX_COLLABORATIVE_DISCUSSIONS.test(value);\n    };\n\n    var isExamAnswer = function (value) {\n      return REGEX_EXAM_ANSWERS.test(value);\n    };\n\n    $(document).ajaxSuccess(function (event, xhr, settings) {\n      if (isCollaborativeDiscuttion(settings.url) || isExamAnswer(settings.url)) {\n        var lessonProgress = app.lessonList.lessonProgress();\n\n        app.lessonList.requirementsExists(lessonProgress, function ($item, content_id) {\n          if (content_id && lessonProgress.enrollment_id) {\n            app.lessonList.checkLessonCompleted(lessonProgress.enrollment_id, content_id, function (completed) {\n              if (completed) {\n                var $currentItemIcon = app.lessonList.currentLesson().find('.js-in-progress-icon');\n                $currentItemIcon.removeClass('icon-clock');\n                $currentItemIcon.removeClass('js-in-progress-icon');\n                $currentItemIcon.addClass('js-in-completed-icon');\n                $currentItemIcon.addClass('icon-check');\n\n                $('.btn-next-lesson').removeClass('disabled');\n                $item.removeClass('disabled');\n                $item.removeClass('blocked');\n                $item.find('.right > .icon-lock').remove();\n              }\n            });\n          }\n        }, function () {\n          $('.btn-next-lesson').removeClass('disabled');\n        });\n\n      }\n    });\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindMasks = function () {\n    var phoneMaskBehavior = function (val) {\n      return val.replace(/\\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';\n    };\n\n    var phoneMaskOptions = {\n      onKeyPress: function (val, e, field, options) {\n        field.mask(phoneMaskBehavior.apply({}, arguments), options);\n      }\n    };\n\n    $('#user-phone').mask(phoneMaskBehavior, phoneMaskOptions);\n    $('#user-cpf').mask('999.999.999-99');\n    $('#user-cep').mask('99.999-999');\n\n    $(document).trigger('app:bind:masks');\n  };\n})();\n","app.notepad = {\n  page: 1,\n\n  noteContainer: function () {\n    return $('#notepad-container');\n  },\n\n  form: function () {\n    return $('#js-notepad-form');\n  },\n\n  loadNote: function (lesson_id, cb) {\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'GET',\n      success: function () {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    })\n  },\n\n  saveNote: function (cb) {\n    var note = $(\"#js-note\").html();\n    var note_id = $(\"#js_note_id\").val();\n\n    var $button = $(\"#save_notepad_button\");\n    var buttonLabel = $button.html();\n    $button.html($button.data(\"sending\"));\n    $button.prop('disabled', true);\n\n    $.ajax({\n      url: window.location.pathname + '/notepads',\n      method: 'POST',\n      data: {\n        _id: note_id,\n        note: note\n      },\n      success: function () {\n        $button.html(buttonLabel);\n        $button.prop('disabled', false);\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    });\n  },\n\n  init: function () {\n    var self = this;\n    if (this.noteContainer().length <= 0) return;\n    this.loadNote($(\"#lesson_id\").val());\n\n    $(\"#notepad_form\").on('submit', function(event) {\n      event.preventDefault();\n      self.saveNote();\n    });\n  }\n};\n","(function () {\n  'use strict';\n\n  app.pagarme = {\n    buildCreditCard: function () {\n      var creditCard = new PagarMe.creditCard();\n      var expiration = $(\"#card-form #card-expiration\").val().split('/');\n\n      creditCard.cardExpirationMonth = parseInt(expiration[0]);\n      creditCard.cardExpirationYear  = parseInt(expiration[1]);\n      creditCard.cardHolderName      = $(\"#card-form #card-holder-name\").val();\n      creditCard.cardNumber          = $(\"#card-form #card-number\").val();\n      creditCard.cardCVV             = $(\"#card-form #card-cvc\").val();\n\n      return creditCard;\n    },\n\n    submitFormCreditCardHash: function (paymentForm) {\n      var creditCard  = app.pagarme.buildCreditCard();\n      var fieldErrors = creditCard.fieldErrors();\n      var hasErrors   = false;\n      for(var field in fieldErrors) { hasErrors = true; break; }\n\n      console.log(1);\n      window.creditCardTest = creditCard;\n\n      if(hasErrors) {\n        window.fieldErrors = fieldErrors;\n\n        console.log(window.fieldErrors);\n      } else {\n        creditCard.generateHash(function(cardHash) {\n          $('#card_hash').val(cardHash);\n\n          paymentForm.get(0).submit();\n        });\n      }\n    },\n\n    init: function () {\n      var src = 'https://assets.pagar.me/js/pagarme.min.js',\n        paymentForm = $('#card-form'),\n        pagarmeKey  = $(\"#pagarme\").val();\n\n      if (paymentForm.length && pagarmeKey) {\n        loadAsset('PagarMe', src, function () {\n          PagarMe.encryption_key = pagarmeKey;\n\n          paymentForm.submit(function(event) {\n            event.preventDefault();\n\n            app.pagarme.submitFormCreditCardHash(paymentForm);\n          });\n\n          $(document).trigger('app:bind:pagarme');\n        });\n      }\n    }\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.bindPostsForm = function () {\n    $(document).on('click', '.js-post-edit', function () {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').addClass('hidden');\n      post.find('.js-post-form').removeClass('hidden');\n    });\n\n    $(document).on('click', '.js-post-cancel', function (e) {\n      var post = $(this).parents('.js-post');\n\n      post.find('.js-post-body').removeClass('hidden');\n      post.find('.js-post-form').addClass('hidden');\n    });\n\n    $(document).trigger('app:bind:bind_posts_form');\n  };\n})();\n","(function () {\n  'use strict';\n\n  app.bindProduct = function () {\n\n    $('.js-product-nav a').on('click', function (e) {\n      e.preventDefault();\n\n      var $el = $(this);\n      var target = $el.attr('href').replace('#', '');\n      var $content = $('.product-content[data-target=\"' + target + '\"]');\n\n      $('.js-product-nav a').removeClass('active');\n      $('.js-product-content').removeClass('active');\n\n      $el.addClass('active');\n      $content.addClass('active');\n    });\n\n    $('.js-product-nav a:first').click();\n  };\n\n})();\n","(function () {\n  'use strict';\n\n  app.bindReadMore = function () {\n    $('[role=\"readmore\"]').each(function (i, el) {\n      var speed = $(el).data('speed') || 100;\n      var collapsedHeight = $(el).data('collapsed-height') || 200;\n      var moreText = $(el).data('more-text') || 'Leia Mais';\n      var lessText = $(el).data('less-text') || 'Fechar';\n\n      var currHeight = $(el).innerHeight();\n      var showLink = currHeight <= collapsedHeight;\n\n      $(el).readmore({\n        speed: speed,\n        collapsedHeight: collapsedHeight,\n        moreLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + moreText + '</a>',\n        lessLink: '<a href=\"#\" class=\"' + (showLink ? 'hidden' : 'readmore-link') + '\">' + lessText + '</a>'\n      })\n    });\n  }\n})();\n","(function () {\n  'use strict';\n\n  app.simpleEditor = {\n\n    createShortcut: function (bindKey, callback) {\n      var isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;\n\n      var bindFunction = function (e) {\n        var character = String.fromCharCode(e.keyCode);\n        var ctrl = e.ctrlKey;\n        var meta = !!e.metaKey;\n        var score = 0;\n\n        if (isMac && meta) {\n          score++;\n        } else if (ctrl) {\n          score++;\n        }\n\n        if (character == bindKey) {\n          score++;\n        }\n\n        if (score == 2) {\n          e.stopPropagation();\n          e.preventDefault();\n          return callback();\n        }\n\n      };\n\n      $('body').bind('keydown', bindFunction);\n    },\n\n    handleDrag: function (e) {\n      e.stopPropagation();\n      e.preventDefault();\n    },\n\n    handleDrop: function (e) {\n      e.stopPropagation();\n      e.preventDefault();\n      var x = e.clientX;\n      var y = e.clientY;\n      var file = e.dataTransfer.files[0];\n\n      var URLObj = window.URL || window.webkitURL;\n      var source = URLObj.createObjectURL(file);\n\n      if (file.type.match('image.*')) {\n\n        var img = document.createElement(\"img\");\n\n        img.src = source;\n\n        var range = null;\n\n        if (document.caretPositionFromPoint) {\n          var pos = document.caretPositionFromPoint(x, y);\n          range = document.createRange();\n          range.setStart(pos.offsetNode, pos.offset);\n          range.collapse();\n          range.insertNode(img);\n        } else if (document.caretRangeFromPoint) {\n          range = document.caretRangeFromPoint(x, y);\n          range.insertNode(img);\n        }\n      }\n    },\n\n    updateButtons: function () {\n      var bold = document.queryCommandState(\"Bold\");\n      var italic = document.queryCommandState(\"Italic\");\n      var underline = document.queryCommandState(\"Underline\");\n\n      if (bold === true) {\n        $('[data-action=bold]').addClass('active');\n      } else {\n        $('[data-action=bold]').removeClass('active');\n      }\n\n      if (italic === true) {\n        $('[data-action=italic]').addClass('active');\n      } else {\n        $('[data-action=italic]').removeClass('active');\n      }\n\n      if (underline === true) {\n        $('[data-action=underline]').addClass('active');\n      } else {\n        $('[data-action=underline]').removeClass('active');\n      }\n    },\n\n    init: function (container) {\n      this.$container = $(container);\n\n      this.$input = this.$container.find('.js-input');\n      this.$btnAction = this.$container.find('.js-btn-action');\n\n      this.registerTriggers();\n      this.registerDropZone();\n      this.registerShortcuts();\n    },\n\n    registerTriggers: function () {\n      var self = this;\n\n      self.$btnAction.on('click', function () {\n        var action = $(this).attr('data-action');\n        document.execCommand(action);\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('click', function () {\n        app.simpleEditor.updateButtons();\n      });\n\n      self.$input.on('focusin', function () {\n        self.$container.addClass('focused');\n      });\n\n      self.$input.on('focusout', function () {\n        self.$container.removeClass('focused');\n      });\n    },\n\n    registerDropZone: function () {\n      var dropZone = $(this.container).find('.js-input');\n      dropZone.on('dragover', app.simpleEditor.handleDrag, false);\n      dropZone.on('drop', app.simpleEditor.handleDrop, false);\n    },\n\n    registerShortcuts: function () {\n\n      app.simpleEditor.createShortcut('U', function () {\n        document.execCommand('underline');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('B', function () {\n        document.execCommand('bold');\n        app.simpleEditor.updateButtons();\n      });\n\n      app.simpleEditor.createShortcut('I', function () {\n        document.execCommand('italic');\n        app.simpleEditor.updateButtons();\n      });\n    }\n  };\n\n})();\n","app.studentDoubts = {\n  page: 1,\n\n  doubtsContainer: function () {\n    return $('#js-doubts-container');\n  },\n\n  form: function () {\n    return $('#js-student-doubts-form');\n  },\n\n  expandButton: function () {\n    return $('#js-expand-student-doubts-form');\n  },\n\n  hideButton: function () {\n    return $('#js-hide-student-doubts-form');\n  },\n\n  loadMoreButton: function () {\n    return $('#js-load-more-doubts');\n  },\n\n  loadDoubts: function (cb) {\n    var self = this;\n\n    $.ajax({\n      url: window.location.pathname + '/student_doubts/page/' + self.page,\n      method: 'GET',\n      data: {\n        per_page: 3\n      },\n      complete: function () {\n        if (typeof cb == 'function') {\n          cb();\n        }\n      }\n    })\n  },\n\n  init: function () {\n    var self = this;\n\n    if (self.doubtsContainer().length <= 0) return;\n\n    self.expandButton().on('click', function () {\n      self.expandButton().hide();\n      self.form().slideDown('fast');\n    });\n\n    self.hideButton().on('click', function () {\n      self.form().slideUp('fast', function () {\n        self.expandButton().fadeIn('fast');\n      });\n    });\n\n    self.loadMoreButton().on('click', function () {\n      self.page = self.page + 1;\n      var $btn = $(this);\n\n      $btn.attr('disabled', 'disabled');\n      self.loadDoubts(function () {\n        $btn.removeAttr('disabled');\n      });\n    });\n\n    self.loadDoubts();\n  }\n};\n","(function () {\n  'use strict';\n\n  app.changeTimeZone = function () {\n    $('.js-to-client-timezone').each(function (i, el) {\n      var $el = $(el);\n      var format = $el.data('format');\n      var zone = moment.tz.guess();\n      var time = $el.data('timezone');\n\n      $el.html(moment.tz(time, zone).format(format));\n    });\n\n    $(document).trigger('app:change:timezone');\n  };\n\n  // TODO: FIXME: Essa chamada é para funcionar no primeiro load. Não deveria\n  // ser assim, parece ser algum erro com a inserção de cod no tema\n  app.changeTimeZone();\n})();\n","(function () {\n  $(document).on('page:load', function () {\n    app.init();\n  });\n\n  $(document).on('page:partial-load', function () {\n    app.bindBlazy();\n  });\n\n  $(document).ready(function () {\n    app.init();\n  });\n})();\n"]}